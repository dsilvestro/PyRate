pdf(file='/home/ubuntu/Software/PyRate/example_files/BDNN_examples/Carnivora/pyrate_mcmc_logs/Carnivora_occs_1_taxon_time_tables_G_BDS_BDNN_16_8TVc_RTT.pdf', width = 9, height = 6, useDingbats = FALSE)

layout(matrix(1:4, ncol = 2, nrow = 2, byrow = TRUE))
par(las = 1, mar = c(4.5, 4.5, 0.5, 0.5))
time_vec=c(23.77883975202193, 20.44001,20.44,15.97001,15.97,13.65001,13.65,11.63001,11.63,7.25001,7.25,5.33001,5.33,2.58001,2.58,1.80001,1.8,0.78101,0.781,0.12601,0.126,0.01171,0.0117,0.0)
sp_mean=c(0.6351004214888254, 0.6351004214888254,0.1336483256236124,0.1336483256236124,0.10141009068427913,0.10141009068427913,0.0943969918664638,0.0943969918664638,0.09376858826016532,0.09376858826016532,0.08736246477442464,0.08736246477442464,0.09529584333215538,0.09529584333215538,0.08860018286734565,0.08860018286734565,0.0970263204437055,0.0970263204437055,0.09691362068106614,0.09691362068106614,0.10359255430300984,0.10359255430300984,0.11278008186527821,0.11278008186527821)
sp_lwr=c(0.4278419623297022, 0.4278419623297022,0.0941521259167579,0.0941521259167579,0.06854472004810978,0.06854472004810978,0.059751322248926673,0.059751322248926673,0.0606439010082283,0.0606439010082283,0.05820887810221688,0.05820887810221688,0.0611782848154245,0.0611782848154245,0.04454164938045718,0.04454164938045718,0.05011010650119098,0.05011010650119098,0.03928404361720448,0.03928404361720448,0.026606113144595774,0.026606113144595774,0.05961370959491095,0.05961370959491095)
sp_upr=c(0.8297374809530177, 0.8297374809530177,0.17979258385670202,0.17979258385670202,0.1358057309065402,0.1358057309065402,0.12668754523255918,0.12668754523255918,0.12438649626897154,0.12438649626897154,0.11772215207723416,0.11772215207723416,0.1284245669652562,0.1284245669652562,0.13129864174565026,0.13129864174565026,0.14797773692895408,0.14797773692895408,0.15864903632698538,0.15864903632698538,0.17763881986660074,0.17763881986660074,0.16011065662055157,0.16011065662055157)
ex_mean=c(0.016713740717735525, 0.016713740717735525,0.03394837021574181,0.03394837021574181,0.03408847021647319,0.03408847021647319,0.03164320662848342,0.03164320662848342,0.03756973667741396,0.03756973667741396,0.041558872564524646,0.041558872564524646,0.04667845660783633,0.04667845660783633,0.07518326775754992,0.07518326775754992,0.0796062419932271,0.0796062419932271,0.08527971923773157,0.08527971923773157,0.32194925267972274,0.32194925267972274,15.30715074444002,15.30715074444002)
ex_lwr=c(1.053334164919874e-05, 1.053334164919874e-05,0.00028516646636960103,0.00028516646636960103,0.00013501887635157644,0.00013501887635157644,0.00013424726050530325,0.00013424726050530325,0.00026827295165987835,0.00026827295165987835,0.00030568094434156465,0.00030568094434156465,0.0002196193064245226,0.0002196193064245226,0.0011661720233641136,0.0011661720233641136,0.0010422918548603022,0.0010422918548603022,0.00011619732806370149,0.00011619732806370149,0.0004441288212659906,0.0004441288212659906,11.535795253829267,11.535795253829267)
ex_upr=c(0.058328232169890054, 0.058328232169890054,0.07116201608703136,0.07116201608703136,0.07232303963103309,0.07232303963103309,0.07321344425419819,0.07321344425419819,0.0851417171191961,0.0851417171191961,0.09443472982294188,0.09443472982294188,0.10551009367511462,0.10551009367511462,0.15940182652179863,0.15940182652179863,0.16938017081566456,0.16938017081566456,0.18507165172788959,0.18507165172788959,0.6351331077971762,0.6351331077971762,18.680496787078976,18.680496787078976)
div_mean=c(0.6183866807710899, 0.6183866807710899,0.09969995540787059,0.09969995540787059,0.06732162046780585,0.06732162046780585,0.0627537852379804,0.0627537852379804,0.056198851582751425,0.056198851582751425,0.045803592209900046,0.045803592209900046,0.048617386724318805,0.048617386724318805,0.013416915109795842,0.013416915109795842,0.01742007845047843,0.01742007845047843,0.011633901443334446,0.011633901443334446,-0.2183566983767128,-0.2183566983767128,-15.194370662574798,-15.194370662574798)
div_lwr=c(0.42843036560675873, 0.42843036560675873,0.04362423474700122,0.04362423474700122,0.017330466171107506,0.017330466171107506,0.0017641528733646356,0.0017641528733646356,-0.004945074200593688,-0.004945074200593688,-0.01920654471248428,-0.01920654471248428,-0.032988882936578576,-0.032988882936578576,-0.08633068576271041,-0.08633068576271041,-0.0953445092513818,-0.0953445092513818,-0.11240231108290971,-0.11240231108290971,-0.5697471372034922,-0.5697471372034922,-18.55348333373823,-18.55348333373823)
div_upr=c(0.8297095578139748, 0.8297095578139748,0.15694711964342456,0.15694711964342456,0.1257555321464911,0.1257555321464911,0.11356556652146274,0.11356556652146274,0.11850667173060202,0.11850667173060202,0.11233162977556166,0.11233162977556166,0.10926161768864145,0.10926161768864145,0.10638629336844332,0.10638629336844332,0.11541975861915572,0.11541975861915572,0.1328830090986652,0.1328830090986652,0.13519644188345398,0.13519644188345398,-11.433433826579236,-11.433433826579236)
long_mean=c(789.7672234065293, 789.7672234065293,66.87386475461341,66.87386475461341,79.43691387080878,79.43691387080878,103.91191542182838,103.91191542182838,89.95664723598605,89.95664723598605,87.29790915463438,87.29790915463438,65.37052749324293,65.37052749324293,39.221447440289296,39.221447440289296,40.6596663671742,40.6596663671742,59.229102254750394,59.229102254750394,15.890842081669522,15.890842081669522,0.06634927913621379,0.06634927913621379)
long_lwr=c(9.277618932654331, 9.277618932654331,10.204782907821127,10.204782907821127,10.258918503862839,10.258918503862839,9.79785080792539,9.79785080792539,8.745774856783576,8.745774856783576,6.62690567559388,6.62690567559388,6.338003784362582,6.338003784362582,4.376720213449947,4.376720213449947,4.142697271206475,4.142697271206475,3.9259245592882874,3.9259245592882874,0.8497250612448762,0.8497250612448762,0.049738452772603456,0.049738452772603456)
long_upr=c(2267.69796004049, 2267.69796004049,203.38696234531895,203.38696234531895,189.63832259689897,189.63832259689897,301.7062161147976,301.7062161147976,280.7690305085719,280.7690305085719,247.87449359597093,247.87449359597093,238.10704566589618,238.10704566589618,120.82332017866612,120.82332017866612,138.82733080356422,138.82733080356422,208.5215464648019,208.5215464648019,44.62862386068984,44.62862386068984,0.08170658136878954,0.08170658136878954)
xlim = c(23.77883975202193, 0.0)
ylim = c(0.026606113144595774, 0.8297374809530177)
not_NA = !is.na(sp_mean)
plot(time_vec[not_NA], sp_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Speciation rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(sp_lwr[not_NA], rev(sp_upr[not_NA])), col = adjustcolor('#4c4cec', alpha = 0.5), border = NA)
lines(time_vec[not_NA], sp_mean[not_NA], col = '#4c4cec', lwd = 2)
ylim = c(1.053334164919874e-05, 18.680496787078976)
not_NA = !is.na(ex_mean)
plot(time_vec[not_NA], ex_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Extinction rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(ex_lwr[not_NA], rev(ex_upr[not_NA])), col = adjustcolor('#e34a33', alpha = 0.5), border = NA)
lines(time_vec[not_NA], ex_mean[not_NA], col = '#e34a33', lwd = 2)
ylim = c(-18.55348333373823, 0.8297095578139748)
not_NA = !is.na(div_mean)
plot(time_vec[not_NA], div_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Net diversification rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(div_lwr[not_NA], rev(div_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], div_mean[not_NA], col = 'black', lwd = 2)
abline(h = 0, col = 'red', lty = 2)
ylim = c(0.049738452772603456, 2267.69796004049)
not_NA = !is.na(long_mean)
plot(time_vec[not_NA], long_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Longevity (Myr)')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(long_lwr[not_NA], rev(long_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], long_mean[not_NA], col = 'black', lwd = 2)
dev.off()