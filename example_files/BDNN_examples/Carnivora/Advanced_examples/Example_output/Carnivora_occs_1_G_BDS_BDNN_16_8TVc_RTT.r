pdf(file='/home/torsten/Work/Software/PyRate/example_files/BDNN_examples/Carnivora/Advanced_examples/Example_output/Carnivora_occs_1_G_BDS_BDNN_16_8TVc_RTT.pdf', width = 9, height = 6, useDingbats = FALSE)

layout(matrix(1:4, ncol = 2, nrow = 2, byrow = TRUE))
par(las = 1, mar = c(4.5, 4.5, 0.5, 0.5))
time_vec=c(23.670092814507477, 22.00001,22.0,21.00001,21.0,20.00001,20.0,19.00001,19.0,18.00001,18.0,17.00001,17.0,16.00001,16.0,15.00001,15.0,14.00001,14.0,13.00001,13.0,12.00001,12.0,11.00001,11.0,10.00001,10.0,9.00001,9.0,8.00001,8.0,7.00001,7.0,6.00001,6.0,5.00001,5.0,4.00001,4.0,3.00001,3.0,2.00001,2.0,1.00001,1.0,0.0)
sp_mean=c(0.3869226270154533, 0.3869226270154533,0.32963108675125474,0.32963108675125474,0.2761955562421086,0.2761955562421086,0.23926319697197565,0.23926319697197565,0.17814851723255007,0.17814851723255007,0.13477650910005334,0.13477650910005334,0.10584507875547443,0.10584507875547443,0.09282264085062047,0.09282264085062047,0.08104664052419837,0.08104664052419837,0.08014308673157963,0.08014308673157963,0.08589928617422068,0.08589928617422068,0.08319724282721284,0.08319724282721284,0.07488133379206681,0.07488133379206681,0.07928704858308591,0.07928704858308591,0.08392493021319596,0.08392493021319596,0.07715197303886114,0.07715197303886114,0.0779313088922319,0.0779313088922319,0.08246411310697986,0.08246411310697986,0.09113177072742802,0.09113177072742802,0.09543164557334499,0.09543164557334499,0.09896357248767358,0.09896357248767358,0.10946023593471416,0.10946023593471416,0.12042962010260379,0.12042962010260379)
sp_lwr=c(0.2636297743491267, 0.2636297743491267,0.24976897453737795,0.24976897453737795,0.2047915213302633,0.2047915213302633,0.173802237790502,0.173802237790502,0.1272672527048946,0.1272672527048946,0.07960105829018183,0.07960105829018183,0.05082863009689941,0.05082863009689941,0.05814076558152846,0.05814076558152846,0.04582559595132178,0.04582559595132178,0.04473878179772819,0.04473878179772819,0.052528212664792406,0.052528212664792406,0.05249431541351371,0.05249431541351371,0.04521746812954379,0.04521746812954379,0.04459832730293479,0.04459832730293479,0.05427868886362826,0.05427868886362826,0.04673989643212582,0.04673989643212582,0.04531277137395796,0.04531277137395796,0.048403759742814086,0.048403759742814086,0.062122906010448065,0.062122906010448065,0.061159504724457685,0.061159504724457685,0.05731868806740464,0.05731868806740464,0.05864889027340218,0.05864889027340218,0.0616015281078566,0.0616015281078566)
sp_upr=c(0.52715940337399, 0.52715940337399,0.4308299335141586,0.4308299335141586,0.34585511038829375,0.34585511038829375,0.29609067719114335,0.29609067719114335,0.23300310033593996,0.23300310033593996,0.18071683616148193,0.18071683616148193,0.16357481080436764,0.16357481080436764,0.14895979617167093,0.14895979617167093,0.12836403688690198,0.12836403688690198,0.11461241165914728,0.11461241165914728,0.12011005664443473,0.12011005664443473,0.11638089922771615,0.11638089922771615,0.1118762285774092,0.1118762285774092,0.10905696788114994,0.10905696788114994,0.11905066692178853,0.11905066692178853,0.10712990969024334,0.10712990969024334,0.10572471697672264,0.10572471697672264,0.10751592456727899,0.10751592456727899,0.1255499310730717,0.1255499310730717,0.12850727882923307,0.12850727882923307,0.14381069881263508,0.14381069881263508,0.16570641574793238,0.16570641574793238,0.18690361473351483,0.18690361473351483)
ex_mean=c(0.07897133447589894, 0.07897133447589894,0.07557124892404277,0.07557124892404277,0.07495499432882215,0.07495499432882215,0.07757453956014851,0.07757453956014851,0.07438243237471023,0.07438243237471023,0.07025437251633676,0.07025437251633676,0.07055634997558742,0.07055634997558742,0.06884426461376442,0.06884426461376442,0.06858984289621797,0.06858984289621797,0.07771379139195572,0.07771379139195572,0.09118279077449577,0.09118279077449577,0.09202466157871786,0.09202466157871786,0.08656141302577483,0.08656141302577483,0.09748637510507928,0.09748637510507928,0.10218936119686181,0.10218936119686181,0.09269396863905936,0.09269396863905936,0.09318920967192099,0.09318920967192099,0.09313584150812404,0.09313584150812404,0.09345812229272249,0.09345812229272249,0.10435200392708989,0.10435200392708989,0.16832093658234143,0.16832093658234143,0.31574622806032077,0.31574622806032077,0.8806117132323494,0.8806117132323494)
ex_lwr=c(0.0493290876800323, 0.0493290876800323,0.05294933430008741,0.05294933430008741,0.05010294210013233,0.05010294210013233,0.04950595160466794,0.04950595160466794,0.04763776206449886,0.04763776206449886,0.04476525008461526,0.04476525008461526,0.03749562121694891,0.03749562121694891,0.041915703883464744,0.041915703883464744,0.041436033783609494,0.041436033783609494,0.048525813185270085,0.048525813185270085,0.06505296267556103,0.06505296267556103,0.06248524356294747,0.06248524356294747,0.053683894858027145,0.053683894858027145,0.06431889328903868,0.06431889328903868,0.06972175682587688,0.06972175682587688,0.05932360954476119,0.05932360954476119,0.05870757878612276,0.05870757878612276,0.05803120843858267,0.05803120843858267,0.055427030824101914,0.055427030824101914,0.06398404214696939,0.06398404214696939,0.10143078265033814,0.10143078265033814,0.21005784681452633,0.21005784681452633,0.6969567564373521,0.6969567564373521)
ex_upr=c(0.10953726773113098, 0.10953726773113098,0.10495825280441706,0.10495825280441706,0.10232042190251844,0.10232042190251844,0.10939929761739178,0.10939929761739178,0.10222389523388861,0.10222389523388861,0.09605607138884484,0.09605607138884484,0.0958740948038317,0.0958740948038317,0.09359340509281207,0.09359340509281207,0.0941840715641393,0.0941840715641393,0.10870571407811426,0.10870571407811426,0.12198138126025054,0.12198138126025054,0.12168480755281541,0.12168480755281541,0.11715596866851621,0.11715596866851621,0.12882184341045724,0.12882184341045724,0.13896897177169415,0.13896897177169415,0.12620624460433003,0.12620624460433003,0.13172404815512226,0.13172404815512226,0.12999059573263977,0.12999059573263977,0.12906110729881612,0.12906110729881612,0.14529623421841723,0.14529623421841723,0.2345306263759134,0.2345306263759134,0.42805615632519606,0.42805615632519606,1.1336699529541836,1.1336699529541836)
div_mean=c(0.3079512925395544, 0.3079512925395544,0.25405983782721187,0.25405983782721187,0.20124056191328654,0.20124056191328654,0.1616886574118271,0.1616886574118271,0.10376608485783977,0.10376608485783977,0.0645221365837167,0.0645221365837167,0.03528872877988704,0.03528872877988704,0.023978376236856076,0.023978376236856076,0.012456797627980395,0.012456797627980395,0.002429295339623901,0.002429295339623901,-0.005283504600275179,-0.005283504600275179,-0.008827418751504985,-0.008827418751504985,-0.011680079233707999,-0.011680079233707999,-0.018199326521993426,-0.018199326521993426,-0.018264430983665845,-0.018264430983665845,-0.01554199560019818,-0.01554199560019818,-0.015257900779689098,-0.015257900779689098,-0.01067172840114411,-0.01067172840114411,-0.00232635156529442,-0.00232635156529442,-0.008920358353744847,-0.008920358353744847,-0.0693573640946679,-0.0693573640946679,-0.20628599212560678,-0.20628599212560678,-0.7601820931297453,-0.7601820931297453)
div_lwr=c(0.19869993405488362, 0.19869993405488362,0.15746644480356128,0.15746644480356128,0.12067665855805275,0.12067665855805275,0.09506437686129007,0.09506437686129007,0.050801962345723095,0.050801962345723095,0.020324695207901658,0.020324695207901658,-0.026161534810222202,-0.026161534810222202,-0.01639517276118526,-0.01639517276118526,-0.025915411271981784,-0.025915411271981784,-0.035560047200495284,-0.035560047200495284,-0.040959897428976794,-0.040959897428976794,-0.04253206228153047,-0.04253206228153047,-0.04705548036815384,-0.04705548036815384,-0.0519627989667551,-0.0519627989667551,-0.057748682896801615,-0.057748682896801615,-0.056760220683738746,-0.056760220683738746,-0.0590285550892371,-0.0590285550892371,-0.050539066501146,-0.050539066501146,-0.05162831269189061,-0.05162831269189061,-0.058369357416533485,-0.058369357416533485,-0.14644574759904536,-0.14644574759904536,-0.3147104793688811,-0.3147104793688811,-0.983001185144862,-0.983001185144862)
div_upr=c(0.46723785671450047, 0.46723785671450047,0.35442828213661076,0.35442828213661076,0.2734582033740902,0.2734582033740902,0.22793411020438697,0.22793411020438697,0.17395099181467105,0.17395099181467105,0.11460025578306238,0.11460025578306238,0.093587642265147,0.093587642265147,0.08429811680282001,0.08429811680282001,0.07441674413480931,0.07441674413480931,0.05078301431251209,0.05078301431251209,0.03281761363000352,0.03281761363000352,0.02849129337310069,0.02849129337310069,0.025279453438159537,0.025279453438159537,0.02450605280107565,0.02450605280107565,0.02585939877690087,0.02585939877690087,0.026832643892384836,0.026832643892384836,0.02737618325715195,0.02737618325715195,0.04072411880742768,0.04072411880742768,0.04208463913783422,0.04208463913783422,0.0484138017712612,0.0484138017712612,0.01965062498109034,0.01965062498109034,-0.09882058844189781,-0.09882058844189781,-0.5123263380480014,-0.5123263380480014)
long_mean=c(13.237512862571805, 13.237512862571805,13.714328433765827,13.714328433765827,13.855335293056045,13.855335293056045,13.487168966720505,13.487168966720505,14.012757762458731,14.012757762458731,14.873157966610686,14.873157966610686,15.041505300414054,15.041505300414054,15.310862251504682,15.310862251504682,15.438792111291443,15.438792111291443,13.54240079656462,13.54240079656462,11.367357411232573,11.367357411232573,11.260000793556138,11.260000793556138,12.0848365428502,12.0848365428502,10.618097426843145,10.618097426843145,10.142043292716277,10.142043292716277,11.263864810361405,11.263864810361405,11.24626381832906,11.24626381832906,11.293731463119359,11.293731463119359,11.341872719478783,11.341872719478783,10.164820915963562,10.164820915963562,6.26917085702459,6.26917085702459,3.282431599302359,3.282431599302359,1.1550654147746382,1.1550654147746382)
long_lwr=c(8.704840134803055, 8.704840134803055,9.394817358096727,9.394817358096727,9.084249482409845,9.084249482409845,8.467107955540765,8.467107955540765,9.291524590775694,9.291524590775694,9.956055763821624,9.956055763821624,9.280274741318511,9.280274741318511,10.344159449699657,10.344159449699657,10.352501639726974,10.352501639726974,8.983498495965895,8.983498495965895,8.197972425533314,8.197972425533314,8.217952759353015,8.217952759353015,8.535629992778455,8.535629992778455,7.422473168759014,7.422473168759014,7.195850895715447,7.195850895715447,7.835497045788873,7.835497045788873,7.591628210684578,7.591628210684578,7.5428465324357985,7.5428465324357985,7.474001145182073,7.474001145182073,6.307323420175815,6.307323420175815,4.104275884840009,4.104275884840009,2.165628915611415,2.165628915611415,0.8795439979786411,0.8795439979786411)
long_upr=c(18.74904105215615, 18.74904105215615,18.5163369882123,18.5163369882123,18.739456764980496,18.739456764980496,19.19467680617603,19.19467680617603,20.176093867476162,20.176093867476162,21.01934673518467,21.01934673518467,23.683233566383397,23.683233566383397,22.87911251395183,22.87911251395183,23.842811377076117,23.842811377076117,19.741207327584117,19.741207327584117,15.372090045880078,15.372090045880078,16.003778540010053,16.003778540010053,18.627560512228257,18.627560512228257,14.57618941788052,14.57618941788052,14.342725219867884,14.342725219867884,16.490329951497326,16.490329951497326,17.033575914331166,17.033575914331166,16.998774652058668,16.998774652058668,17.219761552755475,17.219761552755475,14.943949253186316,14.943949253186316,9.19953787554192,9.19953787554192,4.375279898043098,4.375279898043098,1.4310419506673533,1.4310419506673533)
xlim = c(23.670092814507477, 0.0)
ylim = c(0.04459832730293479, 0.52715940337399)
not_NA = !is.na(sp_mean)
plot(time_vec[not_NA], sp_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Speciation rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(sp_lwr[not_NA], rev(sp_upr[not_NA])), col = adjustcolor('#4c4cec', alpha = 0.5), border = NA)
lines(time_vec[not_NA], sp_mean[not_NA], col = '#4c4cec', lwd = 2)
ylim = c(0.03749562121694891, 1.1336699529541836)
not_NA = !is.na(ex_mean)
plot(time_vec[not_NA], ex_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Extinction rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(ex_lwr[not_NA], rev(ex_upr[not_NA])), col = adjustcolor('#e34a33', alpha = 0.5), border = NA)
lines(time_vec[not_NA], ex_mean[not_NA], col = '#e34a33', lwd = 2)
ylim = c(-0.983001185144862, 0.46723785671450047)
not_NA = !is.na(div_mean)
plot(time_vec[not_NA], div_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Net diversification rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(div_lwr[not_NA], rev(div_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], div_mean[not_NA], col = 'black', lwd = 2)
abline(h = 0, col = 'red', lty = 2)
ylim = c(0.8795439979786411, 23.842811377076117)
not_NA = !is.na(long_mean)
plot(time_vec[not_NA], long_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Longevity (Myr)')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(long_lwr[not_NA], rev(long_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], long_mean[not_NA], col = 'black', lwd = 2)
dev.off()