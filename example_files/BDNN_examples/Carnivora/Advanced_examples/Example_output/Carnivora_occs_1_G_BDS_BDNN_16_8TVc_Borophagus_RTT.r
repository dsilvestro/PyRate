pdf(file='/home/torsten/Work/Software/PyRate/example_files/BDNN_examples/Carnivora/Advanced_examples/Example_output/Carnivora_occs_1_G_BDS_BDNN_16_8TVc_Borophagus_RTT.pdf', width = 9, height = 6, useDingbats = FALSE)

layout(matrix(1:4, ncol = 2, nrow = 2, byrow = TRUE))
par(las = 1, mar = c(4.5, 4.5, 0.5, 0.5))
time_vec=c(23.670092814507477, 22.00001,22.0,21.00001,21.0,20.00001,20.0,19.00001,19.0,18.00001,18.0,17.00001,17.0,16.00001,16.0,15.00001,15.0,14.00001,14.0,13.00001,13.0,12.00001,12.0,11.00001,11.0,10.00001,10.0,9.00001,9.0,8.00001,8.0,7.00001,7.0,6.00001,6.0,5.00001,5.0,4.00001,4.0,3.00001,3.0,2.00001,2.0,1.00001,1.0,0.0)
sp_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.13758957120394277,0.13758957120394277,0.09130209030522901,0.09130209030522901,0.06957373914091317,0.06957373914091317,0.05912151964256424,0.05912151964256424,0.051565128646690404,0.051565128646690404,0.05547806761180968,0.05547806761180968,0.0643372937544065,0.0643372937544065,0.054344866721410624,0.054344866721410624,0.06100707267643686,0.06100707267643686,0.06738856836925596,0.06738856836925596,0.08606804557739216,0.08606804557739216,0.1067464964244851,0.1067464964244851,0.13081047889498176,0.13081047889498176,0.14234726468364375,0.14234726468364375,NA,NA)
sp_lwr=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.042207522880752135,0.042207522880752135,0.020489885747870886,0.020489885747870886,0.014358510731679664,0.014358510731679664,0.012205826017871632,0.012205826017871632,0.01044434253210097,0.01044434253210097,0.013653385040646593,0.013653385040646593,0.01028488642657475,0.01028488642657475,0.006937406325946973,0.006937406325946973,0.004181064508685388,0.004181064508685388,0.012762302906254396,0.012762302906254396,0.009808300266199659,0.009808300266199659,0.01750766668271912,0.01750766668271912,0.0354984021278763,0.0354984021278763,0.020532701497373507,0.020532701497373507,NA,NA)
sp_upr=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.2283541592110732,0.2283541592110732,0.17775905260664057,0.17775905260664057,0.14110554614835044,0.14110554614835044,0.1214752827036818,0.1214752827036818,0.100267766529276,0.100267766529276,0.11796467414562689,0.11796467414562689,0.13109116122866862,0.13109116122866862,0.10818273433189061,0.10818273433189061,0.12491186186703052,0.12491186186703052,0.14166312228087885,0.14166312228087885,0.16757176483791458,0.16757176483791458,0.22851085292123455,0.22851085292123455,0.28657403854692953,0.28657403854692953,0.2950158096200982,0.2950158096200982,NA,NA)
ex_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.11358688258796786,0.11358688258796786,0.08994560855244559,0.08994560855244559,0.10564472424588202,0.10564472424588202,0.11108233160936812,0.11108233160936812,0.10879296861371354,0.10879296861371354,0.13756938888751039,0.13756938888751039,0.16347636003217586,0.16347636003217586,0.15036929738149735,0.15036929738149735,0.16973095062791668,0.16973095062791668,0.18550303595460949,0.18550303595460949,0.2157245815248835,0.2157245815248835,0.25347627682935636,0.25347627682935636,0.4956238646632819,0.4956238646632819,0.8797507485282957,0.8797507485282957,NA,NA)
ex_lwr=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.06858980784597767,0.06858980784597767,0.02241191272318474,0.02241191272318474,0.02854206280521688,0.02854206280521688,0.03475187118516614,0.03475187118516614,0.03620910401416379,0.03620910401416379,0.047393828445969115,0.047393828445969115,0.06894652044683422,0.06894652044683422,0.05554336130621818,0.05554336130621818,0.06810709663507973,0.06810709663507973,0.07927563956191962,0.07927563956191962,0.08668212203436011,0.08668212203436011,0.06816930979298327,0.06816930979298327,0.1414944770885965,0.1414944770885965,0.34204249731697733,0.34204249731697733,NA,NA)
ex_upr=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.1833933503303275,0.1833933503303275,0.15094626407539466,0.15094626407539466,0.188546137802333,0.188546137802333,0.1922192283992586,0.1922192283992586,0.1926266246113915,0.1926266246113915,0.2317715313458119,0.2317715313458119,0.30655454141045924,0.30655454141045924,0.27280749744967153,0.27280749744967153,0.3284153606229125,0.3284153606229125,0.3920111658404969,0.3920111658404969,0.40568375201881707,0.40568375201881707,0.5056838944914491,0.5056838944914491,0.9954265800401413,0.9954265800401413,1.5619296442589268,1.5619296442589268,NA,NA)
div_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.024002688615974925,0.024002688615974925,0.001356481752783359,0.001356481752783359,-0.03607098510496891,-0.03607098510496891,-0.05196081196680383,-0.05196081196680383,-0.057227839967023166,-0.057227839967023166,-0.08209132127570065,-0.08209132127570065,-0.09913906627776937,-0.09913906627776937,-0.09602443066008678,-0.09602443066008678,-0.1087238779514799,-0.1087238779514799,-0.11811446758535364,-0.11811446758535364,-0.12965653594749144,-0.12965653594749144,-0.14672978040487142,-0.14672978040487142,-0.3648133857683,-0.3648133857683,-0.7374034838446518,-0.7374034838446518,NA,NA)
div_lwr=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.058132235510276326,-0.058132235510276326,-0.11845539470299896,-0.11845539470299896,-0.13965088890085575,-0.13965088890085575,-0.16761719050843904,-0.16761719050843904,-0.14229532953639806,-0.14229532953639806,-0.19186977106593545,-0.19186977106593545,-0.2466898807187873,-0.2466898807187873,-0.21558637030713257,-0.21558637030713257,-0.27681361695265483,-0.27681361695265483,-0.3243427331184515,-0.3243427331184515,-0.3653584048951229,-0.3653584048951229,-0.4362131365012854,-0.4362131365012854,-0.8401657688360212,-0.8401657688360212,-1.407384571489625,-1.407384571489625,NA,NA)
div_upr=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.11604599172890011,0.11604599172890011,0.14850811147141363,0.14850811147141363,0.09216161188970562,0.09216161188970562,0.043077608042273646,0.043077608042273646,0.06003517498855471,0.06003517498855471,0.046827165581498215,0.046827165581498215,0.03665930853688343,0.03665930853688343,0.029266733826261104,0.029266733826261104,0.029031018363699285,0.029031018363699285,0.03733840207524594,0.03733840207524594,0.09914706910591983,0.09914706910591983,0.12912364062841156,0.12912364062841156,0.09524402290723794,0.09524402290723794,-0.11657190081351665,-0.11657190081351665,NA,NA)
long_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,9.851600298398422,9.851600298398422,13.505527036909076,13.505527036909076,11.301470264209618,11.301470264209618,10.67958417245285,10.67958417245285,10.893678766281635,10.893678766281635,8.590268330528948,8.590268330528948,7.1821978198713685,7.1821978198713685,7.898095813162535,7.898095813162535,7.014281845279637,7.014281845279637,6.503816364034979,6.503816364034979,5.759570013753736,5.759570013753736,5.124002447977994,5.124002447977994,2.6305171845419766,2.6305171845419766,1.3557433580721452,1.3557433580721452,NA,NA)
long_lwr=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,5.452760409244955,5.452760409244955,5.4274025722387975,5.4274025722387975,2.2863345201653003,2.2863345201653003,4.075640920809212,4.075640920809212,3.6389284113994753,3.6389284113994753,3.401770847256263,3.401770847256263,3.007351705622901,3.007351705622901,2.70760066079797,2.70760066079797,2.692155214875555,2.692155214875555,2.1864472437058278,2.1864472437058278,1.6549460317028974,1.6549460317028974,1.2606575151579418,1.2606575151579418,0.7153863197644456,0.7153863197644456,0.54335384249859,0.54335384249859,NA,NA)
long_upr=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,14.579425594040986,14.579425594040986,25.848448779481053,25.848448779481053,19.443506981792492,19.443506981792492,20.208672145877205,20.208672145877205,20.841637935130006,20.841637935130006,15.483449871170642,15.483449871170642,12.33733579939126,12.33733579939126,13.790823163289703,13.790823163289703,11.6155620718143,11.6155620718143,10.831415624741876,10.831415624741876,10.247407055164755,10.247407055164755,9.60500034152413,9.60500034152413,5.310012500399099,5.310012500399099,2.4172544687888053,2.4172544687888053,NA,NA)
xlim = c(23.670092814507477, 0.0)
ylim = c(0.004181064508685388, 0.2950158096200982)
not_NA = !is.na(sp_mean)
plot(time_vec[not_NA], sp_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Speciation rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(sp_lwr[not_NA], rev(sp_upr[not_NA])), col = adjustcolor('#4c4cec', alpha = 0.5), border = NA)
lines(time_vec[not_NA], sp_mean[not_NA], col = '#4c4cec', lwd = 2)
ylim = c(0.02241191272318474, 1.5619296442589268)
not_NA = !is.na(ex_mean)
plot(time_vec[not_NA], ex_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Extinction rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(ex_lwr[not_NA], rev(ex_upr[not_NA])), col = adjustcolor('#e34a33', alpha = 0.5), border = NA)
lines(time_vec[not_NA], ex_mean[not_NA], col = '#e34a33', lwd = 2)
ylim = c(-1.407384571489625, 0.14850811147141363)
not_NA = !is.na(div_mean)
plot(time_vec[not_NA], div_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Net diversification rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(div_lwr[not_NA], rev(div_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], div_mean[not_NA], col = 'black', lwd = 2)
abline(h = 0, col = 'red', lty = 2)
ylim = c(0.54335384249859, 25.848448779481053)
not_NA = !is.na(long_mean)
plot(time_vec[not_NA], long_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Longevity (Myr)')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(long_lwr[not_NA], rev(long_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], long_mean[not_NA], col = 'black', lwd = 2)
dev.off()