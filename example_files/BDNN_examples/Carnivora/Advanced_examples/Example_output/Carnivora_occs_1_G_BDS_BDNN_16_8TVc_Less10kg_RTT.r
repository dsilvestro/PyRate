pdf(file='/home/torsten/Work/Software/PyRate/example_files/BDNN_examples/Carnivora/Advanced_examples/Example_output/Carnivora_occs_1_G_BDS_BDNN_16_8TVc_Less10kg_RTT.pdf', width = 9, height = 6, useDingbats = FALSE)

layout(matrix(1:4, ncol = 2, nrow = 2, byrow = TRUE))
par(las = 1, mar = c(4.5, 4.5, 0.5, 0.5))
time_vec=c(23.670092814507477, 22.00001,22.0,21.00001,21.0,20.00001,20.0,19.00001,19.0,18.00001,18.0,17.00001,17.0,16.00001,16.0,15.00001,15.0,14.00001,14.0,13.00001,13.0,12.00001,12.0,11.00001,11.0,10.00001,10.0,9.00001,9.0,8.00001,8.0,7.00001,7.0,6.00001,6.0,5.00001,5.0,4.00001,4.0,3.00001,3.0,2.00001,2.0,1.00001,1.0,0.0)
sp_mean=c(0.40015031697953873, 0.40015031697953873,0.33009031296175323,0.33009031296175323,0.27378383308800097,0.27378383308800097,0.23705038102181217,0.23705038102181217,0.18239179723964338,0.18239179723964338,0.14594822909485652,0.14594822909485652,0.1194411731297671,0.1194411731297671,0.10354132883172938,0.10354132883172938,0.09403278679403392,0.09403278679403392,0.08969037069698643,0.08969037069698643,0.09474709435859373,0.09474709435859373,0.0911660406250238,0.0911660406250238,0.0802870749907157,0.0802870749907157,0.09155462727668291,0.09155462727668291,0.1002864762257943,0.1002864762257943,0.09051498917443625,0.09051498917443625,0.09964679716455756,0.09964679716455756,0.10541031816628083,0.10541031816628083,0.11751762426336765,0.11751762426336765,0.1267765995414001,0.1267765995414001,0.1504685885074115,0.1504685885074115,0.17696107133312214,0.17696107133312214,0.20041133404208838,0.20041133404208838)
sp_lwr=c(0.2478913678022486, 0.2478913678022486,0.23488774372746288,0.23488774372746288,0.18827944639591834,0.18827944639591834,0.14395259161442076,0.14395259161442076,0.11946418985692477,0.11946418985692477,0.0897415152765694,0.0897415152765694,0.05569568214935614,0.05569568214935614,0.05823807529811573,0.05823807529811573,0.05255845711742738,0.05255845711742738,0.05254599886825908,0.05254599886825908,0.05437142581985306,0.05437142581985306,0.057131903359005184,0.057131903359005184,0.043745920052611936,0.043745920052611936,0.05195270995054648,0.05195270995054648,0.05386117396269116,0.05386117396269116,0.04947137704665639,0.04947137704665639,0.05292628043054104,0.05292628043054104,0.06015327620125282,0.06015327620125282,0.06677099938218256,0.06677099938218256,0.07216239924399293,0.07216239924399293,0.08941198364332935,0.08941198364332935,0.108143973958267,0.108143973958267,0.1219051465360358,0.1219051465360358)
sp_upr=c(0.5674701589904274, 0.5674701589904274,0.46247137106796127,0.46247137106796127,0.3826683476339439,0.3826683476339439,0.3067580250894774,0.3067580250894774,0.25183600412803653,0.25183600412803653,0.20299234396471136,0.20299234396471136,0.1940207852621152,0.1940207852621152,0.1659801635173312,0.1659801635173312,0.14940459101601522,0.14940459101601522,0.13725240589617388,0.13725240589617388,0.13818856898771317,0.13818856898771317,0.1352155989036148,0.1352155989036148,0.11745851761457121,0.11745851761457121,0.12785880338911787,0.12785880338911787,0.13388227777387107,0.13388227777387107,0.12292095830533603,0.12292095830533603,0.13424954394425417,0.13424954394425417,0.1420583060538741,0.1420583060538741,0.16563666021885134,0.16563666021885134,0.17711764929194895,0.17711764929194895,0.20959895359985284,0.20959895359985284,0.24598878598673918,0.24598878598673918,0.28987235106536646,0.28987235106536646)
ex_mean=c(0.08092277732032685, 0.08092277732032685,0.07936975427215097,0.07936975427215097,0.07808909781389982,0.07808909781389982,0.08499458936655976,0.08499458936655976,0.0793906389508519,0.0793906389508519,0.07477160530679458,0.07477160530679458,0.07479877063177237,0.07479877063177237,0.07291529438844623,0.07291529438844623,0.07277115353405388,0.07277115353405388,0.08825319648755615,0.08825319648755615,0.10793626351332493,0.10793626351332493,0.10882940802260863,0.10882940802260863,0.09956781718599023,0.09956781718599023,0.11145767613158336,0.11145767613158336,0.11612718065114362,0.11612718065114362,0.10917569503966021,0.10917569503966021,0.11579990892700728,0.11579990892700728,0.11472003778291964,0.11472003778291964,0.1176641003221487,0.1176641003221487,0.12793066432473457,0.12793066432473457,0.1922633986716009,0.1922633986716009,0.3639518536864181,0.3639518536864181,0.9538682777464715,0.9538682777464715)
ex_lwr=c(0.049116668618459786, 0.049116668618459786,0.049254664623015476,0.049254664623015476,0.050672395220116274,0.050672395220116274,0.058912001103164455,0.058912001103164455,0.05390245512010598,0.05390245512010598,0.04725949832854421,0.04725949832854421,0.03560643334515981,0.03560643334515981,0.04343703961312943,0.04343703961312943,0.04219105048921385,0.04219105048921385,0.05012837725652228,0.05012837725652228,0.07770423819482014,0.07770423819482014,0.07762383214928033,0.07762383214928033,0.061761757592713365,0.061761757592713365,0.07561805751361689,0.07561805751361689,0.06593629036583247,0.06593629036583247,0.06579641667811494,0.06579641667811494,0.06418036725069881,0.06418036725069881,0.07511492079212456,0.07511492079212456,0.07163028688048595,0.07163028688048595,0.07675377635930433,0.07675377635930433,0.11912101294754762,0.11912101294754762,0.23376134149115924,0.23376134149115924,0.7193452469922775,0.7193452469922775)
ex_upr=c(0.11468677027231701, 0.11468677027231701,0.10577528412652254,0.10577528412652254,0.10450396006989318,0.10450396006989318,0.12412296643882735,0.12412296643882735,0.11095215309831327,0.11095215309831327,0.1054749872354531,0.1054749872354531,0.11109149937376638,0.11109149937376638,0.1063244091025396,0.1063244091025396,0.10740829434018156,0.10740829434018156,0.12165312476556193,0.12165312476556193,0.15236887801884372,0.15236887801884372,0.1530621123788632,0.1530621123788632,0.13648963180216683,0.13648963180216683,0.15552274407856811,0.15552274407856811,0.15640111443050814,0.15640111443050814,0.1431587287183571,0.1431587287183571,0.14952321084075382,0.14952321084075382,0.15825594513855004,0.15825594513855004,0.16175229859156767,0.16175229859156767,0.17743472048894102,0.17743472048894102,0.2645787112736949,0.2645787112736949,0.5152969631560729,0.5152969631560729,1.2003952018360415,1.2003952018360415)
div_mean=c(0.3192275396592121, 0.3192275396592121,0.2507205586896024,0.2507205586896024,0.1956947352741013,0.1956947352741013,0.15205579165525238,0.15205579165525238,0.10300115828879158,0.10300115828879158,0.07117662378806186,0.07117662378806186,0.04464240249799465,0.04464240249799465,0.030626034443283146,0.030626034443283146,0.021261633259980057,0.021261633259980057,0.0014371742094302859,0.0014371742094302859,-0.013189169154731197,-0.013189169154731197,-0.017663367397584832,-0.017663367397584832,-0.019280742195274533,-0.019280742195274533,-0.019903048854900508,-0.019903048854900508,-0.015840704425349284,-0.015840704425349284,-0.018660705865223896,-0.018660705865223896,-0.016153111762449733,-0.016153111762449733,-0.009309719616638849,-0.009309719616638849,-0.00014647605878108217,-0.00014647605878108217,-0.0011540647833344797,-0.0011540647833344797,-0.041794810164189296,-0.041794810164189296,-0.18699078235329586,-0.18699078235329586,-0.7534569437043827,-0.7534569437043827)
div_lwr=c(0.1731041446833748, 0.1731041446833748,0.12457733567080345,0.12457733567080345,0.09442359482129942,0.09442359482129942,0.06335950664063232,0.06335950664063232,0.0311613399605057,0.0311613399605057,0.0002663981939059201,0.0002663981939059201,-0.032315575320910034,-0.032315575320910034,-0.02933364615627683,-0.02933364615627683,-0.03529650789446412,-0.03529650789446412,-0.04704172595502363,-0.04704172595502363,-0.07776079757815278,-0.07776079757815278,-0.06907576806188566,-0.06907576806188566,-0.05737185016907445,-0.05737185016907445,-0.07080751585191704,-0.07080751585191704,-0.07001044986323622,-0.07001044986323622,-0.06569753520498953,-0.06569753520498953,-0.07516925551975844,-0.07516925551975844,-0.07650168420924178,-0.07650168420924178,-0.07342567672433488,-0.07342567672433488,-0.07629504386352733,-0.07629504386352733,-0.1445998569848686,-0.1445998569848686,-0.32387708333363496,-0.32387708333363496,-1.0143568328158072,-1.0143568328158072)
div_upr=c(0.49491320846814113, 0.49491320846814113,0.3546161271323545,0.3546161271323545,0.2903922937126713,0.2903922937126713,0.2425515729624887,0.2425515729624887,0.18480206535994625,0.18480206535994625,0.13536400486494204,0.13536400486494204,0.12273006908018652,0.12273006908018652,0.09666776763111273,0.09666776763111273,0.08829924532445252,0.08829924532445252,0.05076343062360973,0.05076343062360973,0.03269746768080234,0.03269746768080234,0.036072028290280875,0.036072028290280875,0.03282711973669858,0.03282711973669858,0.03078090331781963,0.03078090331781963,0.04628207708474337,0.04628207708474337,0.032280006217872886,0.032280006217872886,0.0357110623455896,0.0357110623455896,0.042873532065094394,0.042873532065094394,0.06137474881097006,0.06137474881097006,0.07279400736648639,0.07279400736648639,0.042702916752772435,0.042702916752772435,-0.03207469072743899,-0.03207469072743899,-0.4923918123194754,-0.4923918123194754)
long_mean=c(13.099587195237476, 13.099587195237476,13.158745415699029,13.158745415699029,13.364127199235291,13.364127199235291,12.3871007238057,12.3871007238057,13.166342233302574,13.166342233302574,14.086112983097903,14.086112983097903,14.553805242852592,14.553805242852592,14.697142297407455,14.697142297407455,14.792570972041043,14.792570972041043,11.967366853677468,11.967366853677468,9.656154838723648,9.656154838723648,9.55016683704051,9.55016683704051,10.467355132153708,10.467355132153708,9.361647080155006,9.361647080155006,9.047189077743667,9.047189077743667,9.552119609833474,9.552119609833474,9.013809117705433,9.013809117705433,9.099862618284533,9.099862618284533,8.941608460453494,8.941608460453494,8.229580292794042,8.229580292794042,5.465799357381684,5.465799357381684,2.8666212177300014,2.8666212177300014,1.0694761478641248,1.0694761478641248)
long_lwr=c(8.630115032719248, 8.630115032719248,9.005180868747656,9.005180868747656,9.569015368711302,9.569015368711302,8.056526754803585,8.056526754803585,8.399179956008634,8.399179956008634,9.414464658408075,9.414464658408075,7.509861740151079,7.509861740151079,9.405178062504884,9.405178062504884,9.060598736453477,9.060598736453477,7.152814576291191,7.152814576291191,6.444162370097622,6.444162370097622,6.321756870587233,6.321756870587233,6.616390371955806,6.616390371955806,5.948086256578529,5.948086256578529,5.894778324460287,5.894778324460287,6.985253424311605,6.985253424311605,6.053344684963982,6.053344684963982,6.07797922477074,6.07797922477074,5.189399779463383,5.189399779463383,4.707871589967444,4.707871589967444,3.3172677485135447,3.3172677485135447,1.7294029648451976,1.7294029648451976,0.8305233512705812,0.8305233512705812)
long_upr=c(20.144345780805303, 20.144345780805303,18.672168148077187,18.672168148077187,19.734610840006496,19.734610840006496,16.97447007866594,16.97447007866594,17.923200925029704,17.923200925029704,20.981140271553006,20.981140271553006,23.60510090422499,23.60510090422499,23.02182673834283,23.02182673834283,23.011563427714673,23.011563427714673,18.03501535949598,18.03501535949598,12.460901455050209,12.460901455050209,12.398452618142558,12.398452618142558,14.489028385029687,14.489028385029687,12.587279445738334,12.587279445738334,13.802919466177554,13.802919466177554,15.198396059957744,15.198396059957744,13.589120563550994,13.589120563550994,12.808901045719471,12.808901045719471,12.220053327806239,12.220053327806239,12.092842132393898,12.092842132393898,7.6714484207393205,7.6714484207393205,4.0324877169096105,4.0324877169096105,1.385901586925607,1.385901586925607)
xlim = c(23.670092814507477, 0.0)
ylim = c(0.043745920052611936, 0.5674701589904274)
not_NA = !is.na(sp_mean)
plot(time_vec[not_NA], sp_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Speciation rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(sp_lwr[not_NA], rev(sp_upr[not_NA])), col = adjustcolor('#4c4cec', alpha = 0.5), border = NA)
lines(time_vec[not_NA], sp_mean[not_NA], col = '#4c4cec', lwd = 2)
ylim = c(0.03560643334515981, 1.2003952018360415)
not_NA = !is.na(ex_mean)
plot(time_vec[not_NA], ex_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Extinction rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(ex_lwr[not_NA], rev(ex_upr[not_NA])), col = adjustcolor('#e34a33', alpha = 0.5), border = NA)
lines(time_vec[not_NA], ex_mean[not_NA], col = '#e34a33', lwd = 2)
ylim = c(-1.0143568328158072, 0.49491320846814113)
not_NA = !is.na(div_mean)
plot(time_vec[not_NA], div_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Net diversification rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(div_lwr[not_NA], rev(div_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], div_mean[not_NA], col = 'black', lwd = 2)
abline(h = 0, col = 'red', lty = 2)
ylim = c(0.8305233512705812, 23.60510090422499)
not_NA = !is.na(long_mean)
plot(time_vec[not_NA], long_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Longevity (Myr)')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(long_lwr[not_NA], rev(long_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], long_mean[not_NA], col = 'black', lwd = 2)
dev.off()