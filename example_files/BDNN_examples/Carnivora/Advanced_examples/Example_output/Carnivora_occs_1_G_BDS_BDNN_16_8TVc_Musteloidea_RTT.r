pdf(file='/home/torsten/Work/Software/PyRate/example_files/BDNN_examples/Carnivora/Advanced_examples/Example_output/Carnivora_occs_1_G_BDS_BDNN_16_8TVc_Musteloidea_RTT.pdf', width = 9, height = 6, useDingbats = FALSE)

layout(matrix(1:4, ncol = 2, nrow = 2, byrow = TRUE))
par(las = 1, mar = c(4.5, 4.5, 0.5, 0.5))
time_vec=c(23.670092814507477, 22.00001,22.0,21.00001,21.0,20.00001,20.0,19.00001,19.0,18.00001,18.0,17.00001,17.0,16.00001,16.0,15.00001,15.0,14.00001,14.0,13.00001,13.0,12.00001,12.0,11.00001,11.0,10.00001,10.0,9.00001,9.0,8.00001,8.0,7.00001,7.0,6.00001,6.0,5.00001,5.0,4.00001,4.0,3.00001,3.0,2.00001,2.0,1.00001,1.0,0.0)
sp_mean=c(0.4803151763118885, 0.4803151763118885,0.39531201126089816,0.39531201126089816,0.34809377084493653,0.34809377084493653,0.3014600486370956,0.3014600486370956,0.24811524250939276,0.24811524250939276,0.19421094750892495,0.19421094750892495,0.16932302312108333,0.16932302312108333,0.13391440330969828,0.13391440330969828,0.1132071350906074,0.1132071350906074,0.0975706262096594,0.0975706262096594,0.10379055080711433,0.10379055080711433,0.10256677026660797,0.10256677026660797,0.09295544274267614,0.09295544274267614,0.10839857061574963,0.10839857061574963,0.11999650349204886,0.11999650349204886,0.11018124968397733,0.11018124968397733,0.12083921181875461,0.12083921181875461,0.12633326597127228,0.12633326597127228,0.13184062435234406,0.13184062435234406,0.13515182049858313,0.13515182049858313,0.14780841100206585,0.14780841100206585,0.17009865067863753,0.17009865067863753,0.18769984864601355,0.18769984864601355)
sp_lwr=c(0.32077533584620693, 0.32077533584620693,0.23849473420629952,0.23849473420629952,0.22202154907545313,0.22202154907545313,0.17666845005257528,0.17666845005257528,0.15977972151206601,0.15977972151206601,0.1315681874902189,0.1315681874902189,0.06084186454658739,0.06084186454658739,0.05347061244467385,0.05347061244467385,0.053711093693800685,0.053711093693800685,0.048543104389118776,0.048543104389118776,0.06102989897730036,0.06102989897730036,0.055709246417362655,0.055709246417362655,0.03626447344241528,0.03626447344241528,0.04853604573974542,0.04853604573974542,0.07212042983310789,0.07212042983310789,0.05831497147118627,0.05831497147118627,0.06723702891303561,0.06723702891303561,0.08135508075371904,0.08135508075371904,0.0795526945487335,0.0795526945487335,0.08030285383227478,0.08030285383227478,0.07682797212317387,0.07682797212317387,0.09357914645249149,0.09357914645249149,0.0980785043554597,0.0980785043554597)
sp_upr=c(0.7332554770076671, 0.7332554770076671,0.5316876499034238,0.5316876499034238,0.476444828601568,0.476444828601568,0.4620632344017424,0.4620632344017424,0.34435177751944807,0.34435177751944807,0.2869973712136997,0.2869973712136997,0.28409539405850454,0.28409539405850454,0.19870493737792821,0.19870493737792821,0.17500337735569807,0.17500337735569807,0.15446221868523152,0.15446221868523152,0.1638048416329149,0.1638048416329149,0.15313596990009282,0.15313596990009282,0.12967995606430358,0.12967995606430358,0.1491755238424878,0.1491755238424878,0.1800304176140791,0.1800304176140791,0.16039746751695574,0.16039746751695574,0.17120186327445447,0.17120186327445447,0.18536161555207567,0.18536161555207567,0.1867512618328772,0.1867512618328772,0.19768874798808847,0.19768874798808847,0.22153030732363718,0.22153030732363718,0.2469674243323987,0.2469674243323987,0.2817129088484359,0.2817129088484359)
ex_mean=c(0.08505984679075612, 0.08505984679075612,0.07941862177629377,0.07941862177629377,0.07883504428080122,0.07883504428080122,0.08719117886343232,0.08719117886343232,0.08090663760950784,0.08090663760950784,0.07332558784848274,0.07332558784848274,0.07226142230801456,0.07226142230801456,0.06966855476422101,0.06966855476422101,0.07023002165054455,0.07023002165054455,0.08445367168788943,0.08445367168788943,0.10285215672253535,0.10285215672253535,0.10691730165415361,0.10691730165415361,0.10147630707945413,0.10147630707945413,0.11688217496697632,0.11688217496697632,0.12371504689275807,0.12371504689275807,0.11866173768579462,0.11866173768579462,0.12673578230031735,0.12673578230031735,0.12853254934451847,0.12853254934451847,0.13191298124974812,0.13191298124974812,0.14078371765033748,0.14078371765033748,0.20604161152934672,0.20604161152934672,0.3851383694358819,0.3851383694358819,0.9985852077845481,0.9985852077845481)
ex_lwr=c(0.04338393754331294, 0.04338393754331294,0.04734822038152324,0.04734822038152324,0.044008151520047965,0.044008151520047965,0.048079702073119936,0.048079702073119936,0.03674512380413922,0.03674512380413922,0.02952413118721276,0.02952413118721276,0.027824087248924538,0.027824087248924538,0.029761495427756073,0.029761495427756073,0.029812086614845495,0.029812086614845495,0.03911476301046338,0.03911476301046338,0.06511867257701873,0.06511867257701873,0.06419935115538082,0.06419935115538082,0.06284555558179596,0.06284555558179596,0.07467094134398203,0.07467094134398203,0.08458240133504354,0.08458240133504354,0.07629054529348124,0.07629054529348124,0.08824897351936312,0.08824897351936312,0.08121540856264967,0.08121540856264967,0.08953716078682662,0.08953716078682662,0.0825892967998994,0.0825892967998994,0.11681872039700165,0.11681872039700165,0.24470656063832585,0.24470656063832585,0.7523764283313931,0.7523764283313931)
ex_upr=c(0.12839321332676076, 0.12839321332676076,0.11433332128973796,0.11433332128973796,0.12056110274174131,0.12056110274174131,0.13317560289038477,0.13317560289038477,0.11543718897524467,0.11543718897524467,0.10304910580826834,0.10304910580826834,0.10921795075028223,0.10921795075028223,0.1041137152432629,0.1041137152432629,0.10241944145263007,0.10241944145263007,0.12314374587072682,0.12314374587072682,0.14717411732335123,0.14717411732335123,0.14556868624450853,0.14556868624450853,0.14482384816703342,0.14482384816703342,0.15591512207830563,0.15591512207830563,0.1778522858383009,0.1778522858383009,0.162979196536028,0.162979196536028,0.17662901710891052,0.17662901710891052,0.17174268283952018,0.17174268283952018,0.18384524468290964,0.18384524468290964,0.1974397197731397,0.1974397197731397,0.280184360905344,0.280184360905344,0.5350023304546392,0.5350023304546392,1.2797197136738725,1.2797197136738725)
div_mean=c(0.3952553295211319, 0.3952553295211319,0.3158933894846042,0.3158933894846042,0.2692587265641354,0.2692587265641354,0.21426886977366333,0.21426886977366333,0.16720860489988493,0.16720860489988493,0.1208853596604421,0.1208853596604421,0.09706160081306874,0.09706160081306874,0.06424584854547731,0.06424584854547731,0.04297711344006283,0.04297711344006283,0.01311695452176994,0.01311695452176994,0.0009383940845789673,0.0009383940845789673,-0.004350531387545649,-0.004350531387545649,-0.008520864336777996,-0.008520864336777996,-0.008483604351226663,-0.008483604351226663,-0.003718543400709187,-0.003718543400709187,-0.00848048800181727,-0.00848048800181727,-0.0058965704815625445,-0.0058965704815625445,-0.0021992833732462453,-0.0021992833732462453,-7.235689740404778e-05,-7.235689740404778e-05,-0.005631897151754342,-0.005631897151754342,-0.05823320052728083,-0.05823320052728083,-0.21503971875724437,-0.21503971875724437,-0.8108853591385349,-0.8108853591385349)
div_lwr=c(0.21595292364494764, 0.21595292364494764,0.1581732916782312,0.1581732916782312,0.14804143302471193,0.14804143302471193,0.11116061671797751,0.11116061671797751,0.046593874940332555,0.046593874940332555,0.04268501635187852,0.04268501635187852,-0.010393251318502078,-0.010393251318502078,-0.009224652981661259,-0.009224652981661259,-0.031680348748617554,-0.031680348748617554,-0.039088220545057666,-0.039088220545057666,-0.05974763463263312,-0.05974763463263312,-0.05807544382399,-0.05807544382399,-0.05505203083538178,-0.05505203083538178,-0.06075297096765091,-0.06075297096765091,-0.06291918554119277,-0.06291918554119277,-0.06339053649680365,-0.06339053649680365,-0.06865909822772949,-0.06865909822772949,-0.05790946626445398,-0.05790946626445398,-0.0691322249022845,-0.0691322249022845,-0.06853889739516697,-0.06853889739516697,-0.1521054863493121,-0.1521054863493121,-0.3921787909505481,-0.3921787909505481,-1.0575683354075596,-1.0575683354075596)
div_upr=c(0.6247248898845558, 0.6247248898845558,0.4620828209950014,0.4620828209950014,0.4146218784148318,0.4146218784148318,0.3918311076967066,0.3918311076967066,0.25274265979552313,0.25274265979552313,0.22159532267860804,0.22159532267860804,0.2349188657821523,0.2349188657821523,0.16695147322380297,0.16695147322380297,0.11488222138571802,0.11488222138571802,0.0724138290811118,0.0724138290811118,0.06302195748624628,0.06302195748624628,0.054682402424371425,0.054682402424371425,0.05748642829569911,0.05748642829569911,0.05245312343807094,0.05245312343807094,0.060934069582237085,0.060934069582237085,0.06339643082561676,0.06339643082561676,0.06189428638546825,0.06189428638546825,0.06987727560271537,0.06987727560271537,0.06614689600909482,0.06614689600909482,0.07806920198640677,0.07806920198640677,0.05496674482520525,0.05496674482520525,-0.08319058393610404,-0.08319058393610404,-0.5158857542767771,-0.5158857542767771)
long_mean=c(12.847695579586837, 12.847695579586837,13.472189106728223,13.472189106728223,13.649609240069983,13.649609240069983,12.422497741695567,12.422497741695567,13.351756413934535,13.351756413934535,14.865896011873131,14.865896011873131,15.655110316426361,15.655110316426361,15.933432872870837,15.933432872870837,15.793128559084835,15.793128559084835,12.870681136136112,12.870681136136112,10.281834230799488,10.281834230799488,9.84054144147581,9.84054144147581,10.444755703688942,10.444755703688942,8.921581724442941,8.921581724442941,8.456128510889059,8.456128510889059,8.790643700687381,8.790643700687381,8.197638810868314,8.197638810868314,8.077271811214022,8.077271811214022,7.916436728196849,7.916436728196849,7.465521618078565,7.465521618078565,5.125170992636637,5.125170992636637,2.7297695970380005,2.7297695970380005,1.0228302012786241,1.0228302012786241)
long_lwr=c(5.833250512265057, 5.833250512265057,8.746356606451137,8.746356606451137,7.961250795628469,7.961250795628469,7.420815872476168,7.420815872476168,6.8198086600816215,6.8198086600816215,8.821632351266457,8.821632351266457,6.836480894336781,6.836480894336781,7.811559552005895,7.811559552005895,7.716258159129991,7.716258159129991,7.129774233755346,7.129774233755346,6.725778032066977,6.725778032066977,6.056029107227466,6.056029107227466,6.418620118351951,6.418620118351951,5.869733805108213,5.869733805108213,5.622643506022612,5.622643506022612,5.987266166255933,5.987266166255933,5.544749748669104,5.544749748669104,5.446633657008604,5.446633657008604,5.439357442857811,5.439357442857811,4.4916114198895745,4.4916114198895745,3.095903283973102,3.095903283973102,1.7752746471480916,1.7752746471480916,0.7814211106658336,0.7814211106658336)
long_upr=c(20.026218452364205, 20.026218452364205,21.12011796731079,21.12011796731079,21.555788345157943,21.555788345157943,20.382734775624996,20.382734775624996,20.536792358561623,20.536792358561623,26.446106285600735,26.446106285600735,28.42501542806865,28.42501542806865,28.60948713788509,28.60948713788509,26.759950373110616,26.759950373110616,21.15839347978082,21.15839347978082,15.016663923852267,15.016663923852267,13.673136275031249,13.673136275031249,14.862814052331197,14.862814052331197,12.456238063587733,12.456238063587733,11.82279037029051,11.82279037029051,12.58409550285,12.58409550285,11.190054155347466,11.190054155347466,11.025233491767054,11.025233491767054,11.168547128502734,11.168547128502734,10.569138354030624,10.569138354030624,7.339538815641557,7.339538815641557,3.9057184034704564,3.9057184034704564,1.329121916030493,1.329121916030493)
xlim = c(23.670092814507477, 0.0)
ylim = c(0.03626447344241528, 0.7332554770076671)
not_NA = !is.na(sp_mean)
plot(time_vec[not_NA], sp_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Speciation rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(sp_lwr[not_NA], rev(sp_upr[not_NA])), col = adjustcolor('#4c4cec', alpha = 0.5), border = NA)
lines(time_vec[not_NA], sp_mean[not_NA], col = '#4c4cec', lwd = 2)
ylim = c(0.027824087248924538, 1.2797197136738725)
not_NA = !is.na(ex_mean)
plot(time_vec[not_NA], ex_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Extinction rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(ex_lwr[not_NA], rev(ex_upr[not_NA])), col = adjustcolor('#e34a33', alpha = 0.5), border = NA)
lines(time_vec[not_NA], ex_mean[not_NA], col = '#e34a33', lwd = 2)
ylim = c(-1.0575683354075596, 0.6247248898845558)
not_NA = !is.na(div_mean)
plot(time_vec[not_NA], div_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Net diversification rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(div_lwr[not_NA], rev(div_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], div_mean[not_NA], col = 'black', lwd = 2)
abline(h = 0, col = 'red', lty = 2)
ylim = c(0.7814211106658336, 28.60948713788509)
not_NA = !is.na(long_mean)
plot(time_vec[not_NA], long_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Longevity (Myr)')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(long_lwr[not_NA], rev(long_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], long_mean[not_NA], col = 'black', lwd = 2)
dev.off()