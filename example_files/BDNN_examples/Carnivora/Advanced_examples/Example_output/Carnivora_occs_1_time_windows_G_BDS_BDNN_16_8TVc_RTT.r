pdf(file='/home/ubuntu/Software/PyRate/example_files/BDNN_examples/Carnivora/pyrate_mcmc_logs/Carnivora_occs_1_time_windows_G_BDS_BDNN_16_8TVc_RTT.pdf', width = 9, height = 6, useDingbats = FALSE)

layout(matrix(1:4, ncol = 2, nrow = 2, byrow = TRUE))
par(las = 1, mar = c(4.5, 4.5, 0.5, 0.5))
time_vec=c(23.83389688449395, 20.44001,20.44,15.97001,15.97,13.65001,13.65,11.63001,11.63,7.25001,7.25,5.33001,5.33,2.58001,2.58,1.80001,1.8,0.78101,0.781,0.12601,0.126,0.01171,0.0117,0.0)
sp_mean=c(0.39701851768624713, 0.39701851768624713,0.18132054353202628,0.18132054353202628,0.08333951233272435,0.08333951233272435,0.08668030017229959,0.08668030017229959,0.08445808756907235,0.08445808756907235,0.07834011897412772,0.07834011897412772,0.09100435541532599,0.09100435541532599,0.09154152955600935,0.09154152955600935,0.10107911621140873,0.10107911621140873,0.10596871449522764,0.10596871449522764,0.11237120608865361,0.11237120608865361,0.10269664338119053,0.10269664338119053)
sp_lwr=c(0.26403950736694154, 0.26403950736694154,0.13238465687961046,0.13238465687961046,0.044250644372209526,0.044250644372209526,0.04644442424563545,0.04644442424563545,0.05222216544317216,0.05222216544317216,0.04608553596746561,0.04608553596746561,0.056765948649802445,0.056765948649802445,0.04532378346850155,0.04532378346850155,0.04181439027566723,0.04181439027566723,0.04179274561012974,0.04179274561012974,0.0430026698472839,0.0430026698472839,0.051296600994332295,0.051296600994332295)
sp_upr=c(0.5401154341289416, 0.5401154341289416,0.22977405044078048,0.22977405044078048,0.1264561298778672,0.1264561298778672,0.11978078980507352,0.11978078980507352,0.11632259558187127,0.11632259558187127,0.10809993976216316,0.10809993976216316,0.12744293221534286,0.12744293221534286,0.14127532682539762,0.14127532682539762,0.15226057253265599,0.15226057253265599,0.17511958212730758,0.17511958212730758,0.18906142094246672,0.18906142094246672,0.1605530307847798,0.1605530307847798)
ex_mean=c(0.08012718534772309, 0.08012718534772309,0.0688053697864787,0.0688053697864787,0.0576985934443992,0.0576985934443992,0.08644265376759352,0.08644265376759352,0.0916132097601435,0.0916132097601435,0.07807301685894272,0.07807301685894272,0.10755045450241339,0.10755045450241339,0.1372573213478109,0.1372573213478109,0.20222763978088737,0.20222763978088737,0.16731590805603205,0.16731590805603205,0.18730023999925996,0.18730023999925996,10.438887288100322,10.438887288100322)
ex_lwr=c(0.03677250905170483, 0.03677250905170483,0.026215306148775826,0.026215306148775826,0.00930586275865443,0.00930586275865443,0.04387948578828331,0.04387948578828331,0.04533626295460312,0.04533626295460312,0.023309707896845673,0.023309707896845673,0.05000116161646419,0.05000116161646419,0.06129406094949254,0.06129406094949254,0.1026434187366181,0.1026434187366181,0.054844924326988696,0.054844924326988696,0.015674639807593118,0.015674639807593118,7.394202634948782,7.394202634948782)
ex_upr=c(0.1143931275879884, 0.1143931275879884,0.10500464179773394,0.10500464179773394,0.09544108422028598,0.09544108422028598,0.12695337892027436,0.12695337892027436,0.13197797192223742,0.13197797192223742,0.12234419549766269,0.12234419549766269,0.17053906276321118,0.17053906276321118,0.20946700629535522,0.20946700629535522,0.302174265782783,0.302174265782783,0.284960741365488,0.284960741365488,0.2977077787879899,0.2977077787879899,14.264499548440615,14.264499548440615)
div_mean=c(0.3168913323385238, 0.3168913323385238,0.11251517374554794,0.11251517374554794,0.02564091888832514,0.02564091888832514,0.00023764640470597364,0.00023764640470597364,-0.007155122191071016,-0.007155122191071016,0.0002671021151850655,0.0002671021151850655,-0.016546099087087367,-0.016546099087087367,-0.04571579179180179,-0.04571579179180179,-0.10114852356947886,-0.10114852356947886,-0.06134719356080407,-0.06134719356080407,-0.07492903391060636,-0.07492903391060636,-10.336190644719121,-10.336190644719121)
div_lwr=c(0.1623200538855153, 0.1623200538855153,0.05201282923222733,0.05201282923222733,-0.03547871944755908,-0.03547871944755908,-0.05075581126172625,-0.05075581126172625,-0.05488812060974982,-0.05488812060974982,-0.05154554993676475,-0.05154554993676475,-0.08484417554097659,-0.08484417554097659,-0.13140226435113506,-0.13140226435113506,-0.20876517992703397,-0.20876517992703397,-0.17334336189072574,-0.17334336189072574,-0.22959851760224242,-0.22959851760224242,-14.204637076988268,-14.204637076988268)
div_upr=c(0.44300312408302595, 0.44300312408302595,0.17411660266493734,0.17411660266493734,0.08604222055955671,0.08604222055955671,0.053056733930605296,0.053056733930605296,0.053276498643353196,0.053276498643353196,0.06385106077230346,0.06385106077230346,0.04963987203616725,0.04963987203616725,0.04324978438032176,0.04324978438032176,0.01591206488765879,0.01591206488765879,0.08782513557689102,0.08782513557689102,0.08890359444589443,0.08890359444589443,-7.332801071381345,-7.332801071381345)
long_mean=c(13.589204631348595, 13.589204631348595,16.541931426673056,16.541931426673056,24.453336840410696,24.453336840410696,12.908466440856689,12.908466440856689,12.343393844827485,12.343393844827485,15.595279866769536,15.595279866769536,10.603941800097813,10.603941800097813,8.704600444405283,8.704600444405283,5.550639790215292,5.550639790215292,7.8636554224379465,7.8636554224379465,7.6688122105110175,7.6688122105110175,0.10015036308623117,0.10015036308623117)
long_lwr=c(7.659763754026174, 7.659763754026174,8.417275701720506,8.417275701720506,8.058490936325267,8.058490936325267,7.419703687755309,7.419703687755309,6.739555445181038,6.739555445181038,6.949289191628313,6.949289191628313,5.464502403447027,5.464502403447027,4.065739900974525,4.065739900974525,3.0817326546852972,3.0817326546852972,2.8601564098299104,2.8601564098299104,2.316189168533267,2.316189168533267,0.07010410681455133,0.07010410681455133)
long_upr=c(21.899266834011403, 21.899266834011403,30.33745763618813,30.33745763618813,60.019426208245626,60.019426208245626,21.14885558827697,21.14885558827697,20.1595170254071,20.1595170254071,32.25582148412093,32.25582148412093,18.83911007198513,18.83911007198513,13.502844665680763,13.502844665680763,8.708639688550923,8.708639688550923,15.10418479594616,15.10418479594616,16.939150523635988,16.939150523635988,0.13524108674997473,0.13524108674997473)
xlim = c(23.83389688449395, 0.0)
ylim = c(0.04179274561012974, 0.5401154341289416)
not_NA = !is.na(sp_mean)
plot(time_vec[not_NA], sp_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Speciation rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(sp_lwr[not_NA], rev(sp_upr[not_NA])), col = adjustcolor('#4c4cec', alpha = 0.5), border = NA)
lines(time_vec[not_NA], sp_mean[not_NA], col = '#4c4cec', lwd = 2)
ylim = c(0.00930586275865443, 14.264499548440615)
not_NA = !is.na(ex_mean)
plot(time_vec[not_NA], ex_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Extinction rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(ex_lwr[not_NA], rev(ex_upr[not_NA])), col = adjustcolor('#e34a33', alpha = 0.5), border = NA)
lines(time_vec[not_NA], ex_mean[not_NA], col = '#e34a33', lwd = 2)
ylim = c(-14.204637076988268, 0.44300312408302595)
not_NA = !is.na(div_mean)
plot(time_vec[not_NA], div_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Net diversification rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(div_lwr[not_NA], rev(div_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], div_mean[not_NA], col = 'black', lwd = 2)
abline(h = 0, col = 'red', lty = 2)
ylim = c(0.07010410681455133, 60.019426208245626)
not_NA = !is.na(long_mean)
plot(time_vec[not_NA], long_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Longevity (Myr)')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(long_lwr[not_NA], rev(long_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], long_mean[not_NA], col = 'black', lwd = 2)
dev.off()