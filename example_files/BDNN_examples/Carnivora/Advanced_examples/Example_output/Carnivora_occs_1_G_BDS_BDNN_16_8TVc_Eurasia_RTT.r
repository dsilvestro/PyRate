pdf(file='/home/torsten/Work/Software/PyRate/example_files/BDNN_examples/Carnivora/Advanced_examples/Example_output/Carnivora_occs_1_G_BDS_BDNN_16_8TVc_Eurasia_RTT.pdf', width = 9, height = 6, useDingbats = FALSE)

layout(matrix(1:4, ncol = 2, nrow = 2, byrow = TRUE))
par(las = 1, mar = c(4.5, 4.5, 0.5, 0.5))
time_vec=c(23.670092814507477, 22.00001,22.0,21.00001,21.0,20.00001,20.0,19.00001,19.0,18.00001,18.0,17.00001,17.0,16.00001,16.0,15.00001,15.0,14.00001,14.0,13.00001,13.0,12.00001,12.0,11.00001,11.0,10.00001,10.0,9.00001,9.0,8.00001,8.0,7.00001,7.0,6.00001,6.0,5.00001,5.0,4.00001,4.0,3.00001,3.0,2.00001,2.0,1.00001,1.0,0.0)
sp_mean=c(0.36437222624171445, 0.36437222624171445,0.30270480262636085,0.30270480262636085,0.24633223392553458,0.24633223392553458,0.2160641896666742,0.2160641896666742,0.15769836362472425,0.15769836362472425,0.1253333582507863,0.1253333582507863,0.09947303163138423,0.09947303163138423,0.08870704470486938,0.08870704470486938,0.07735906811282418,0.07735906811282418,0.08164913526315151,0.08164913526315151,0.08916825131937736,0.08916825131937736,0.08606706412630931,0.08606706412630931,0.07788190311214577,0.07788190311214577,0.08133044964215726,0.08133044964215726,0.08387058198606706,0.08387058198606706,0.078135343540654,0.078135343540654,0.07648627003001719,0.07648627003001719,0.07857959222253987,0.07857959222253987,0.08291229000454783,0.08291229000454783,0.08740348660358917,0.08740348660358917,0.09059381805142692,0.09059381805142692,0.10200931313951789,0.10200931313951789,0.11210155525208189,0.11210155525208189)
sp_lwr=c(0.23584844496875124, 0.23584844496875124,0.19973696040912736,0.19973696040912736,0.17160610640158674,0.17160610640158674,0.15311647172655204,0.15311647172655204,0.10910182332321734,0.10910182332321734,0.061380631103058386,0.061380631103058386,0.04577881442951513,0.04577881442951513,0.04646579493797419,0.04646579493797419,0.038809512568524766,0.038809512568524766,0.0408111624182876,0.0408111624182876,0.04945241588529176,0.04945241588529176,0.04434135624745316,0.04434135624745316,0.039842438784942716,0.039842438784942716,0.03962086849022235,0.03962086849022235,0.04735734494206752,0.04735734494206752,0.041244151227318254,0.041244151227318254,0.03961680601100618,0.03961680601100618,0.04438995331840549,0.04438995331840549,0.05255948449841634,0.05255948449841634,0.04987579930361997,0.04987579930361997,0.04619863643266171,0.04619863643266171,0.04405181759870312,0.04405181759870312,0.04656017894995663,0.04656017894995663)
sp_upr=c(0.5116349343550276, 0.5116349343550276,0.3947406430658842,0.3947406430658842,0.3346088815733227,0.3346088815733227,0.2987352629836504,0.2987352629836504,0.20967525618607377,0.20967525618607377,0.1645298595954018,0.1645298595954018,0.16504073355397503,0.16504073355397503,0.13749164441916106,0.13749164441916106,0.11696159787096502,0.11696159787096502,0.1195974348361479,0.1195974348361479,0.12723657649737194,0.12723657649737194,0.11658347156572395,0.11658347156572395,0.11002460126252721,0.11002460126252721,0.11277610464036432,0.11277610464036432,0.12255584491834863,0.12255584491834863,0.11119272573114804,0.11119272573114804,0.10601652090369192,0.10601652090369192,0.10794805699877245,0.10794805699877245,0.11659612147931042,0.11659612147931042,0.12354426349099479,0.12354426349099479,0.13945376353943684,0.13945376353943684,0.15368036285716785,0.15368036285716785,0.1755054947593947,0.1755054947593947)
ex_mean=c(0.07228644812102752, 0.07228644812102752,0.06701473092082061,0.06701473092082061,0.06449039939080924,0.06449039939080924,0.06770091371235737,0.06770091371235737,0.06214909012012777,0.06214909012012777,0.0600634000817305,0.0600634000817305,0.05789132268743173,0.05789132268743173,0.05728663736711143,0.05728663736711143,0.05812112732550307,0.05812112732550307,0.07290888310787651,0.07290888310787651,0.08772845788452016,0.08772845788452016,0.08913396804092973,0.08913396804092973,0.08298722270838367,0.08298722270838367,0.09312965320967939,0.09312965320967939,0.09714960617765835,0.09714960617765835,0.08723800614517693,0.08723800614517693,0.08735708537162798,0.08735708537162798,0.08731052864730236,0.08731052864730236,0.0870129777908939,0.0870129777908939,0.09857554299306784,0.09857554299306784,0.1524782408226553,0.1524782408226553,0.28126123023299965,0.28126123023299965,0.8507818506371255,0.8507818506371255)
ex_lwr=c(0.04167017358976262, 0.04167017358976262,0.04231515595044913,0.04231515595044913,0.038861920440135984,0.038861920440135984,0.03735210921331816,0.03735210921331816,0.03502571342269972,0.03502571342269972,0.03518524996301675,0.03518524996301675,0.027189306883707336,0.027189306883707336,0.03123496667900929,0.03123496667900929,0.031569658583459864,0.031569658583459864,0.04065400177147572,0.04065400177147572,0.05677997394427337,0.05677997394427337,0.054790261786186414,0.054790261786186414,0.047426469200833675,0.047426469200833675,0.05518624559454943,0.05518624559454943,0.05328005031356117,0.05328005031356117,0.042858317850138626,0.042858317850138626,0.045230304412442156,0.045230304412442156,0.041716460925420584,0.041716460925420584,0.04792553815346538,0.04792553815346538,0.054854986388051225,0.054854986388051225,0.0904449331544218,0.0904449331544218,0.1757397660552853,0.1757397660552853,0.6110636339462959,0.6110636339462959)
ex_upr=c(0.10671861256904427, 0.10671861256904427,0.09772759654212738,0.09772759654212738,0.09393336342600116,0.09393336342600116,0.09901543891692088,0.09901543891692088,0.09285389561068405,0.09285389561068405,0.09151654479847265,0.09151654479847265,0.0833700290561458,0.0833700290561458,0.08501945050895258,0.08501945050895258,0.08628060582938414,0.08628060582938414,0.10304103102432395,0.10304103102432395,0.12018883020437382,0.12018883020437382,0.1181306977871454,0.1181306977871454,0.11126790185357215,0.11126790185357215,0.12624075652525307,0.12624075652525307,0.12882766732120493,0.12882766732120493,0.11661592408651483,0.11661592408651483,0.11909189837332051,0.11909189837332051,0.11846804694355217,0.11846804694355217,0.12568064009145904,0.12568064009145904,0.14512551169775187,0.14512551169775187,0.21717982383505746,0.21717982383505746,0.3918742959078784,0.3918742959078784,1.09372276219045,1.09372276219045)
div_mean=c(0.2920857781206869, 0.2920857781206869,0.23569007170554038,0.23569007170554038,0.18184183453472527,0.18184183453472527,0.1483632759543169,0.1483632759543169,0.09554927350459644,0.09554927350459644,0.06526995816905577,0.06526995816905577,0.04158170894395247,0.04158170894395247,0.03142040733775792,0.03142040733775792,0.0192379407873211,0.0192379407873211,0.008740252155275033,0.008740252155275033,0.00143979343485717,0.00143979343485717,-0.0030669039146204,-0.0030669039146204,-0.005105319596237942,-0.005105319596237942,-0.011799203567522178,-0.011799203567522178,-0.01327902419159133,-0.01327902419159133,-0.009102662604522924,-0.009102662604522924,-0.010870815341610787,-0.010870815341610787,-0.00873093642476245,-0.00873093642476245,-0.00410068778634607,-0.00410068778634607,-0.011172056389478725,-0.011172056389478725,-0.061884422771228326,-0.061884422771228326,-0.17925191709348173,-0.17925191709348173,-0.7386802953850441,-0.7386802953850441)
div_lwr=c(0.14781449711482142, 0.14781449711482142,0.1297437858006234,0.1297437858006234,0.10829077985392142,0.10829077985392142,0.06676952731405925,0.06676952731405925,0.034035597726769465,0.034035597726769465,0.004480296398422026,0.004480296398422026,-0.017514490094592564,-0.017514490094592564,-0.01915065281985799,-0.01915065281985799,-0.030725765132732702,-0.030725765132732702,-0.033333173209987105,-0.033333173209987105,-0.03632584861489575,-0.03632584861489575,-0.040965249179374885,-0.040965249179374885,-0.04460002680916939,-0.04460002680916939,-0.050049021697761195,-0.050049021697761195,-0.05606507239957212,-0.05606507239957212,-0.0526181773160604,-0.0526181773160604,-0.057914722312272765,-0.057914722312272765,-0.05509770063852617,-0.05509770063852617,-0.051753577791419175,-0.051753577791419175,-0.0664047659247206,-0.0664047659247206,-0.1358273053497191,-0.1358273053497191,-0.28929722600368146,-0.28929722600368146,-0.9839299334139197,-0.9839299334139197)
div_upr=c(0.4374174531982812, 0.4374174531982812,0.3385799240818538,0.3385799240818538,0.27589836611306223,0.27589836611306223,0.23611153988879013,0.23611153988879013,0.16189568220850406,0.16189568220850406,0.11195240868495213,0.11195240868495213,0.1008951130858445,0.1008951130858445,0.08526082672394422,0.08526082672394422,0.06922955847159606,0.06922955847159606,0.05631094204554782,0.05631094204554782,0.04949329972503262,0.04949329972503262,0.04130685906389003,0.04130685906389003,0.04078948481926789,0.04078948481926789,0.035408727566707376,0.035408727566707376,0.046774861141556726,0.046774861141556726,0.0396339268126727,0.0396339268126727,0.03846140045052557,0.03846140045052557,0.0466598837648598,0.0466598837648598,0.0554746522756535,0.0554746522756535,0.04810709819791449,0.04810709819791449,0.025099045797885147,0.025099045797885147,-0.07277211807140238,-0.07277211807140238,-0.4707856713575954,-0.4707856713575954)
long_mean=c(14.66708149987567, 14.66708149987567,15.69194571554355,15.69194571554355,16.3863919193927,16.3863919193927,15.758032256968546,15.758032256968546,17.19371635378683,17.19371635378683,17.835614307969323,17.835614307969323,18.796201597249457,18.796201597249457,18.870602278917854,18.870602278917854,18.644485051096083,18.644485051096083,14.659789980236743,14.659789980236743,11.936755844172776,11.936755844172776,11.736953249195786,11.736953249195786,12.726982325329343,12.726982325329343,11.250532319350752,11.250532319350752,10.814118475080662,10.814118475080662,12.146544082388179,12.146544082388179,12.202434861379265,12.202434861379265,12.28332603376327,12.28332603376327,12.496314741802765,12.496314741802765,11.02202026500084,11.02202026500084,6.997413966541743,6.997413966541743,3.7157950056195146,3.7157950056195146,1.2002179997240607,1.2002179997240607)
long_lwr=c(8.511392651351505, 8.511392651351505,9.911991313493665,9.911991313493665,10.019718672923254,10.019718672923254,9.367253718591192,9.367253718591192,10.668317670120459,10.668317670120459,10.680241888736687,10.680241888736687,9.481050380929164,9.481050380929164,11.21410580331564,11.21410580331564,10.953362870132807,10.953362870132807,9.704871836578763,9.704871836578763,7.832053851073922,7.832053851073922,7.77739612846394,7.77739612846394,8.658630439225854,8.658630439225854,7.601959525762583,7.601959525762583,7.105212240547256,7.105212240547256,7.5411940210718775,7.5411940210718775,7.498469578451519,7.498469578451519,7.533674978231004,7.533674978231004,7.893536440359071,7.893536440359071,6.571811257171685,6.571811257171685,4.190170277359004,4.190170277359004,2.355523083750788,2.355523083750788,0.8289985843030362,0.8289985843030362)
long_upr=c(21.720732335686744, 21.720732335686744,22.342759236171098,22.342759236171098,23.906643483047713,23.906643483047713,23.24766352303992,23.24766352303992,28.407079266334094,28.407079266334094,28.020829045481975,28.020829045481975,31.364713513885345,31.364713513885345,30.883084143258916,30.883084143258916,30.244509569823908,30.244509569823908,24.597824480384492,24.597824480384492,17.073148303049706,17.073148303049706,16.693346281778705,16.693346281778705,19.512503955543856,19.512503955543856,16.931092118763857,16.931092118763857,16.06271371380923,16.06271371380923,18.84193543482502,18.84193543482502,19.77674703292571,19.77674703292571,19.471125281675977,19.471125281675977,20.64697884141292,20.64697884141292,17.893102608465256,17.893102608465256,9.970780794535571,9.970780794535571,5.038532490124789,5.038532490124789,1.4954547858537395,1.4954547858537395)
xlim = c(23.670092814507477, 0.0)
ylim = c(0.038809512568524766, 0.5116349343550276)
not_NA = !is.na(sp_mean)
plot(time_vec[not_NA], sp_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Speciation rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(sp_lwr[not_NA], rev(sp_upr[not_NA])), col = adjustcolor('#4c4cec', alpha = 0.5), border = NA)
lines(time_vec[not_NA], sp_mean[not_NA], col = '#4c4cec', lwd = 2)
ylim = c(0.027189306883707336, 1.09372276219045)
not_NA = !is.na(ex_mean)
plot(time_vec[not_NA], ex_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Extinction rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(ex_lwr[not_NA], rev(ex_upr[not_NA])), col = adjustcolor('#e34a33', alpha = 0.5), border = NA)
lines(time_vec[not_NA], ex_mean[not_NA], col = '#e34a33', lwd = 2)
ylim = c(-0.9839299334139197, 0.4374174531982812)
not_NA = !is.na(div_mean)
plot(time_vec[not_NA], div_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Net diversification rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(div_lwr[not_NA], rev(div_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], div_mean[not_NA], col = 'black', lwd = 2)
abline(h = 0, col = 'red', lty = 2)
ylim = c(0.8289985843030362, 31.364713513885345)
not_NA = !is.na(long_mean)
plot(time_vec[not_NA], long_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Longevity (Myr)')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(long_lwr[not_NA], rev(long_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], long_mean[not_NA], col = 'black', lwd = 2)
dev.off()