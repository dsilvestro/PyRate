pdf(file='C:/Users/SimoesLabAdmin/Documents/PyRate/example_files/BDNN_examples/Carnivora/pyrate_mcmc_logs/Carnivora_1_G_BDS_BDNN_16_8TVc_RTT.pdf', width = 9, height = 6, useDingbats = FALSE)

layout(matrix(1:4, ncol = 2, nrow = 2, byrow = TRUE))
par(las = 1, mar = c(4.5, 4.5, 0.5, 0.5))
time_vec=c(40.106191248436055, 35.00001,35.0,30.00001,30.0,25.00001,25.0,20.00001,20.0,15.00001,15.0,10.00001,10.0,5.00001,5.0,1.00001,1.0,0.50001,0.5,0.0)
sp_mean=c(0.6043844540018078, 0.6043844540018078,0.6033816694474973,0.6033816694474973,0.603146131950332,0.603146131950332,0.6031192679645234,0.6031192679645234,0.6033986886163805,0.6033986886163805,0.6028614416067294,0.6028614416067294,0.6027514555453173,0.6027514555453173,0.601418920214852,0.601418920214852,0.6014338696412497,0.6014338696412497,0.6014899480377707,0.6014899480377707)
sp_lwr=c(0.5165853610727518, 0.5165853610727518,0.5107589830956513,0.5107589830956513,0.5083774506373514,0.5083774506373514,0.5081529612674021,0.5081529612674021,0.5085306929611976,0.5085306929611976,0.5056950725117827,0.5056950725117827,0.5046827138058074,0.5046827138058074,0.502064450778645,0.502064450778645,0.5014523792900475,0.5014523792900475,0.5016234008591433,0.5016234008591433)
sp_upr=c(0.6714599965430073, 0.6714599965430073,0.6720394656446198,0.6720394656446198,0.6726688552315097,0.6726688552315097,0.672849131510936,0.672849131510936,0.6730632350964706,0.6730632350964706,0.6735389401527333,0.6735389401527333,0.6738571988723828,0.6738571988723828,0.6736607411078901,0.6736607411078901,0.6743816040811317,0.6743816040811317,0.6743728556345615,0.6743728556345615)
ex_mean=c(0.6666647602622904, 0.6666647602622904,0.6643321611307993,0.6643321611307993,0.6630934386857101,0.6630934386857101,0.663470068044197,0.663470068044197,0.6636834626232239,0.6636834626232239,0.6617497797882457,0.6617497797882457,0.660148983753293,0.660148983753293,0.6588018381797269,0.6588018381797269,0.6565838761534134,0.6565838761534134,0.6565562014444426,0.6565562014444426)
ex_lwr=c(0.6431249997044688, 0.6431249997044688,0.6331229518335486,0.6331229518335486,0.6297010070066068,0.6297010070066068,0.6304544156136628,0.6304544156136628,0.6307818948335405,0.6307818948335405,0.6251913816495759,0.6251913816495759,0.6196109509896858,0.6196109509896858,0.6136308930961086,0.6136308930961086,0.6063739087448272,0.6063739087448272,0.606148069305211,0.606148069305211)
ex_upr=c(0.69670045450607, 0.69670045450607,0.696987968752361,0.696987968752361,0.6969077989267928,0.6969077989267928,0.6968960156307212,0.6968960156307212,0.6968264087314868,0.6968264087314868,0.6969848680856819,0.6969848680856819,0.6971133360069451,0.6971133360069451,0.6975239936930437,0.6975239936930437,0.6979735255353002,0.6979735255353002,0.698030459197184,0.698030459197184)
div_mean=c(-0.06228030626048264, -0.06228030626048264,-0.06095049168330194,-0.06095049168330194,-0.05994730673537813,-0.05994730673537813,-0.06035080007967368,-0.06035080007967368,-0.060284774006842845,-0.060284774006842845,-0.058888338181516786,-0.058888338181516786,-0.057397528207975286,-0.057397528207975286,-0.057382917964875206,-0.057382917964875206,-0.05515000651216411,-0.05515000651216411,-0.05506625340667189,-0.05506625340667189)
div_lwr=c(-0.12492934459190441, -0.12492934459190441,-0.12236396873789734,-0.12236396873789734,-0.1213235563692554,-0.1213235563692554,-0.12230145434626072,-0.12230145434626072,-0.12225120187234295,-0.12225120187234295,-0.11949630913779319,-0.11949630913779319,-0.11602566617701104,-0.11602566617701104,-0.11407238568612599,-0.11407238568612599,-0.10856668567346806,-0.10856668567346806,-0.10817368976064301,-0.10817368976064301)
div_upr=c(-0.022433894607578053, -0.022433894607578053,-0.023469053930402106,-0.023469053930402106,-0.023033862061254795,-0.023033862061254795,-0.02267722466858757,-0.02267722466858757,-0.022323928240400526,-0.022323928240400526,-0.02250809301985157,-0.02250809301985157,-0.022634250518055232,-0.022634250518055232,-0.023378798927774613,-0.023378798927774613,-0.022891865342585693,-0.022891865342585693,-0.022901448094306276,-0.022901448094306276)
long_mean=c(1.501699513632666, 1.501699513632666,1.5073477350048181,1.5073477350048181,1.5103263496813428,1.5103263496813428,1.5094234226721166,1.5094234226721166,1.508911135226551,1.508911135226551,1.5136267120591438,1.5136267120591438,1.517563751871894,1.517563751871894,1.520952986736689,1.520952986736689,1.526528601286265,1.526528601286265,1.5266084949024297,1.5266084949024297)
long_lwr=c(1.4353370857335754, 1.4353370857335754,1.4347449953692082,1.4347449953692082,1.4349100433944861,1.4349100433944861,1.4349343052204948,1.4349343052204948,1.4350776426806424,1.4350776426806424,1.4347513780988825,1.4347513780988825,1.4344869741382158,1.4344869741382158,1.4336424396033973,1.4336424396033973,1.4327190980962567,1.4327190980962567,1.432602240810689,1.432602240810689)
long_upr=c(1.554907678071174, 1.554907678071174,1.5794720395208566,1.5794720395208566,1.5880552657104263,1.5880552657104263,1.586157500422349,1.586157500422349,1.585334024629692,1.585334024629692,1.59951021295509,1.59951021295509,1.6139159554922817,1.6139159554922817,1.629644157833131,1.629644157833131,1.6491474741549568,1.6491474741549568,1.6497619156755483,1.6497619156755483)
xlim = c(40.106191248436055, 0.0)
ylim = c(0.5014523792900475, 0.6743816040811317)
not_NA = !is.na(sp_mean)
plot(time_vec[not_NA], sp_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Speciation rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(sp_lwr[not_NA], rev(sp_upr[not_NA])), col = adjustcolor('#4c4cec', alpha = 0.5), border = NA)
lines(time_vec[not_NA], sp_mean[not_NA], col = '#4c4cec', lwd = 2)
ylim = c(0.606148069305211, 0.698030459197184)
not_NA = !is.na(ex_mean)
plot(time_vec[not_NA], ex_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Extinction rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(ex_lwr[not_NA], rev(ex_upr[not_NA])), col = adjustcolor('#e34a33', alpha = 0.5), border = NA)
lines(time_vec[not_NA], ex_mean[not_NA], col = '#e34a33', lwd = 2)
ylim = c(-0.12492934459190441, -0.022323928240400526)
not_NA = !is.na(div_mean)
plot(time_vec[not_NA], div_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Net diversification rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(div_lwr[not_NA], rev(div_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], div_mean[not_NA], col = 'black', lwd = 2)
abline(h = 0, col = 'red', lty = 2)
ylim = c(1.432602240810689, 1.6497619156755483)
not_NA = !is.na(long_mean)
plot(time_vec[not_NA], long_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Longevity (Myr)')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(long_lwr[not_NA], rev(long_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], long_mean[not_NA], col = 'black', lwd = 2)
dev.off()