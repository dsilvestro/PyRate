pdf(file='/Users/shelleywang/Documents/PU_RSII/PyRate/example_files/BDNN_examples/Carnivora/pyrate_mcmc_logs/Carnivora_occs_1_G_BDS_BDNN_16_8TVc_RTT.pdf', width = 9, height = 6, useDingbats = FALSE)

layout(matrix(1:4, ncol = 2, nrow = 2, byrow = TRUE))
par(las = 1, mar = c(4.5, 4.5, 0.5, 0.5))
time_vec=c(27.6665369462284, 22.00001,22.0,21.00001,21.0,20.00001,20.0,19.00001,19.0,18.00001,18.0,17.00001,17.0,16.00001,16.0,15.00001,15.0,14.00001,14.0,13.00001,13.0,12.00001,12.0,11.00001,11.0,10.00001,10.0,9.00001,9.0,8.00001,8.0,7.00001,7.0,6.00001,6.0,5.00001,5.0,4.00001,4.0,3.00001,3.0,2.00001,2.0,1.00001,1.0,0.0)
sp_mean=c(0.2366801762770177, 0.2366801762770177,0.23483976164851003,0.23483976164851003,0.2302963937690633,0.2302963937690633,0.2048781230336163,0.2048781230336163,0.20185479793606315,0.20185479793606315,0.1913854048613629,0.1913854048613629,0.20106508022549816,0.20106508022549816,0.18397178525669175,0.18397178525669175,0.17568150964592105,0.17568150964592105,0.144790307541026,0.144790307541026,0.13070166169394742,0.13070166169394742,0.12420225427686804,0.12420225427686804,0.12094909290541675,0.12094909290541675,0.1130034060822645,0.1130034060822645,0.108601924359758,0.108601924359758,0.10764930082390732,0.10764930082390732,0.10377431427179952,0.10377431427179952,0.10655379922990865,0.10655379922990865,0.10478193953379959,0.10478193953379959,0.10394718730904866,0.10394718730904866,0.11411474040162893,0.11411474040162893,0.12859922748215288,0.12859922748215288,0.15393189557264705,0.15393189557264705)
sp_lwr=c(0.17243606490744004, 0.17243606490744004,0.19725466964425534,0.19725466964425534,0.1948833581705438,0.1948833581705438,0.1679895027041197,0.1679895027041197,0.16051249111246876,0.16051249111246876,0.14976966352417678,0.14976966352417678,0.14699046488357984,0.14699046488357984,0.1357417328058897,0.1357417328058897,0.13063438928710003,0.13063438928710003,0.12100015970068152,0.12100015970068152,0.10711125099706358,0.10711125099706358,0.10152915846182492,0.10152915846182492,0.09720890668216614,0.09720890668216614,0.09179033681924555,0.09179033681924555,0.08535799642995076,0.08535799642995076,0.0828255391360563,0.0828255391360563,0.07842510499755195,0.07842510499755195,0.0805195636750466,0.0805195636750466,0.07821871445842606,0.07821871445842606,0.0754028942998672,0.0754028942998672,0.0825419321633141,0.0825419321633141,0.09383539683411128,0.09383539683411128,0.11924958519291276,0.11924958519291276)
sp_upr=c(0.28365592896245084, 0.28365592896245084,0.27485277018857684,0.27485277018857684,0.2629663013296172,0.2629663013296172,0.22802273277339694,0.22802273277339694,0.2259565631495575,0.2259565631495575,0.21576357089658432,0.21576357089658432,0.23781655188197853,0.23781655188197853,0.21038465026434952,0.21038465026434952,0.2026528462966742,0.2026528462966742,0.15945317126864916,0.15945317126864916,0.14568116535270675,0.14568116535270675,0.13960210718840724,0.13960210718840724,0.13633049449762755,0.13633049449762755,0.1300808117324561,0.1300808117324561,0.12658047471902673,0.12658047471902673,0.12309851863392109,0.12309851863392109,0.12052983578015702,0.12052983578015702,0.12147413266929748,0.12147413266929748,0.12003596708082243,0.12003596708082243,0.12019339135523464,0.12019339135523464,0.14288347209325483,0.14288347209325483,0.16620192319300384,0.16620192319300384,0.208929646897919,0.208929646897919)
ex_mean=c(0.10579664740481831, 0.10579664740481831,0.10555659895006415,0.10555659895006415,0.10493825203852511,0.10493825203852511,0.10690138887884208,0.10690138887884208,0.10592078192845429,0.10592078192845429,0.10412659516034688,0.10412659516034688,0.09910693831585769,0.09910693831585769,0.10200775508469226,0.10200775508469226,0.10223766437359308,0.10223766437359308,0.10677284903933792,0.10677284903933792,0.10909912924490607,0.10909912924490607,0.10976973174747624,0.10976973174747624,0.10782112618284917,0.10782112618284917,0.11454978678439043,0.11454978678439043,0.12016289139775946,0.12016289139775946,0.11556760086839203,0.11556760086839203,0.12097718775120783,0.12097718775120783,0.1277375077580435,0.1277375077580435,0.1389308202705911,0.1389308202705911,0.16201329574392737,0.16201329574392737,0.2844574264916306,0.2844574264916306,0.43858506009787745,0.43858506009787745,0.6705469529774997,0.6705469529774997)
ex_lwr=c(0.08926871525262181, 0.08926871525262181,0.08824471265819785,0.08824471265819785,0.08928821088654118,0.08928821088654118,0.09110172958709187,0.09110172958709187,0.09167496516347183,0.09167496516347183,0.09135861795901645,0.09135861795901645,0.08767059406180601,0.08767059406180601,0.09115621635036061,0.09115621635036061,0.09150682501639268,0.09150682501639268,0.09089815641757192,0.09089815641757192,0.09078548737421901,0.09078548737421901,0.09100690356583481,0.09100690356583481,0.09037474207280678,0.09037474207280678,0.09781205873119066,0.09781205873119066,0.1024786410802604,0.1024786410802604,0.09858526147530842,0.09858526147530842,0.10479659504041156,0.10479659504041156,0.10972220301633241,0.10972220301633241,0.11793452132969309,0.11793452132969309,0.13597879419707445,0.13597879419707445,0.2359011061299821,0.2359011061299821,0.3714292132850858,0.3714292132850858,0.5776140175346937,0.5776140175346937)
ex_upr=c(0.11751804945925433, 0.11751804945925433,0.11898705358758127,0.11898705358758127,0.1187300165177437,0.1187300165177437,0.11823211474914425,0.11823211474914425,0.11918268290931497,0.11918268290931497,0.11718272834456343,0.11718272834456343,0.11338640279501107,0.11338640279501107,0.11586224395219208,0.11586224395219208,0.11496528123432498,0.11496528123432498,0.11707984365876563,0.11707984365876563,0.12138165106334597,0.12138165106334597,0.12517276015621645,0.12517276015621645,0.1227345582899586,0.1227345582899586,0.13148870096875778,0.13148870096875778,0.1379755112138588,0.1379755112138588,0.13367590034897586,0.13367590034897586,0.14130115498947238,0.14130115498947238,0.14836775551209813,0.14836775551209813,0.16193754079567285,0.16193754079567285,0.18500031883158483,0.18500031883158483,0.3294924086724531,0.3294924086724531,0.5123868662716135,0.5123868662716135,0.7486642682981604,0.7486642682981604)
div_mean=c(0.13088352887219937, 0.13088352887219937,0.12928316269844592,0.12928316269844592,0.12535814173053822,0.12535814173053822,0.0979767341547742,0.0979767341547742,0.09593401600760879,0.09593401600760879,0.08725880970101607,0.08725880970101607,0.10195814190964049,0.10195814190964049,0.08196403017199944,0.08196403017199944,0.0734438452723279,0.0734438452723279,0.038017458501688105,0.038017458501688105,0.02160253244904134,0.02160253244904134,0.014432522529391792,0.014432522529391792,0.013127966722567568,0.013127966722567568,-0.001546380702125971,-0.001546380702125971,-0.011560967038001455,-0.011560967038001455,-0.007918300044484705,-0.007918300044484705,-0.01720287347940829,-0.01720287347940829,-0.021183708528134823,-0.021183708528134823,-0.03414888073679145,-0.03414888073679145,-0.05806610843487872,-0.05806610843487872,-0.17034268609000172,-0.17034268609000172,-0.30998583261572443,-0.30998583261572443,-0.5166150574048526,-0.5166150574048526)
div_lwr=c(0.06765722010983695, 0.06765722010983695,0.07643655258227768,0.07643655258227768,0.07629714927255662,0.07629714927255662,0.06170143395114577,0.06170143395114577,0.0554338101803222,0.0554338101803222,0.04759960236846224,0.04759960236846224,0.05197290732763722,0.05197290732763722,0.03528382571803061,0.03528382571803061,0.027880498458094788,0.027880498458094788,0.009235201423534373,0.009235201423534373,-0.0026095333227090373,-0.0026095333227090373,-0.00961865080849468,-0.00961865080849468,-0.007737196373890379,-0.007737196373890379,-0.020567807660094445,-0.020567807660094445,-0.028482254417599287,-0.028482254417599287,-0.024062708035247182,-0.024062708035247182,-0.03969412207822795,-0.03969412207822795,-0.0484862433388204,-0.0484862433388204,-0.059289254074669576,-0.059289254074669576,-0.09217913957161253,-0.09217913957161253,-0.21936097145401712,-0.21936097145401712,-0.3694351749256959,-0.3694351749256959,-0.604434387201382,-0.604434387201382)
div_upr=c(0.18173160189937185, 0.18173160189937185,0.15930796268724817,0.15930796268724817,0.15722937321038188,0.15722937321038188,0.12435196136300594,0.12435196136300594,0.12820396991093552,0.12820396991093552,0.11647572068937159,0.11647572068937159,0.13951135155782862,0.13951135155782862,0.10963642254951617,0.10963642254951617,0.10083216529494204,0.10083216529494204,0.06111451236343106,0.06111451236343106,0.045185316132942396,0.045185316132942396,0.03554946744341979,0.03554946744341979,0.0314160122464221,0.0314160122464221,0.014217833247079315,0.014217833247079315,0.0019149966589341177,0.0019149966589341177,0.007901044174197264,0.007901044174197264,-0.0007977503863393076,-0.0007977503863393076,-0.0023984200955847884,-0.0023984200955847884,-0.005127518737327752,-0.005127518737327752,-0.02487794659262592,-0.02487794659262592,-0.12105525725027863,-0.12105525725027863,-0.2280634995219164,-0.2280634995219164,-0.4014342974329321,-0.4014342974329321)
long_mean=c(9.51480479384818, 9.51480479384818,9.538833898730777,9.538833898730777,9.592006297436162,9.592006297436162,9.418342664216432,9.418342664216432,9.497924410526679,9.497924410526679,9.653158959315359,9.653158959315359,10.143901196242902,10.143901196242902,9.849875622053279,9.849875622053279,9.82525047983711,9.82525047983711,9.427501463489593,9.427501463489593,9.250969564007747,9.250969564007747,9.20113093596732,9.20113093596732,9.355473145418268,9.355473145418268,8.802610383301898,8.802610383301898,8.406599009812949,8.406599009812949,8.738838873514009,8.738838873514009,8.336391052098,8.336391052098,7.888508933032935,7.888508933032935,7.254715521659633,7.254715521659633,6.2256510589973235,6.2256510589973235,3.5539029711816434,3.5539029711816434,2.301090186158698,2.301090186158698,1.5011707254289146,1.5011707254289146)
long_lwr=c(8.509331158927365, 8.509331158927365,7.877585827604026,7.877585827604026,8.422469981300425,8.422469981300425,8.457938878296499,8.457938878296499,8.390480693918352,8.390480693918352,8.533680808827096,8.533680808827096,8.722527731218715,8.722527731218715,8.63093934563038,8.63093934563038,8.698278204197806,8.698278204197806,8.541179837193361,8.541179837193361,8.238477490128435,8.238477490128435,7.988958610100099,7.988958610100099,8.147664471464626,8.147664471464626,7.605216209700055,7.605216209700055,7.247662945419521,7.247662945419521,7.480779986440251,7.480779986440251,6.998704405098493,6.998704405098493,6.740008949710495,6.740008949710495,6.175220366361899,6.175220366361899,5.40539608967026,5.40539608967026,2.9744125790070326,2.9744125790070326,1.9516503365445466,1.9516503365445466,1.3203662050215852,1.3203662050215852)
long_upr=c(11.202132764766436, 11.202132764766436,10.699379070610897,10.699379070610897,11.199686835148968,11.199686835148968,10.976740008476076,10.976740008476076,10.908103408785946,10.908103408785946,10.94587486479492,10.94587486479492,11.285438384727616,11.285438384727616,10.970178886719928,10.970178886719928,10.928146614428579,10.928146614428579,11.001323232631433,11.001323232631433,11.014976390201953,11.014976390201953,10.988177388944955,10.988177388944955,11.06503849487493,11.06503849487493,10.2236882954097,10.2236882954097,9.758130957423688,9.758130957423688,10.143504059686032,10.143504059686032,9.433636408798936,9.433636408798936,9.113925645943763,9.113925645943763,8.479281458263094,8.479281458263094,7.354087862778789,7.354087862778789,4.133240185603324,4.133240185603324,2.692303039805495,2.692303039805495,1.7156182883748397,1.7156182883748397)
xlim = c(27.6665369462284, 0.0)
ylim = c(0.0754028942998672, 0.28365592896245084)
not_NA = !is.na(sp_mean)
plot(time_vec[not_NA], sp_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Speciation rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(sp_lwr[not_NA], rev(sp_upr[not_NA])), col = adjustcolor('#4c4cec', alpha = 0.5), border = NA)
lines(time_vec[not_NA], sp_mean[not_NA], col = '#4c4cec', lwd = 2)
ylim = c(0.08767059406180601, 0.7486642682981604)
not_NA = !is.na(ex_mean)
plot(time_vec[not_NA], ex_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Extinction rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(ex_lwr[not_NA], rev(ex_upr[not_NA])), col = adjustcolor('#e34a33', alpha = 0.5), border = NA)
lines(time_vec[not_NA], ex_mean[not_NA], col = '#e34a33', lwd = 2)
ylim = c(-0.604434387201382, 0.18173160189937185)
not_NA = !is.na(div_mean)
plot(time_vec[not_NA], div_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Net diversification rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(div_lwr[not_NA], rev(div_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], div_mean[not_NA], col = 'black', lwd = 2)
abline(h = 0, col = 'red', lty = 2)
ylim = c(1.3203662050215852, 11.285438384727616)
not_NA = !is.na(long_mean)
plot(time_vec[not_NA], long_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Longevity (Myr)')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(long_lwr[not_NA], rev(long_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], long_mean[not_NA], col = 'black', lwd = 2)
dev.off()