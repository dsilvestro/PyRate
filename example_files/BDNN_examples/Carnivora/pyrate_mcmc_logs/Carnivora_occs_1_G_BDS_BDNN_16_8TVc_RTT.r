pdf(file='C:/Users/SimoesLabAdmin/Documents/PyRate/example_files/BDNN_examples/Carnivora/pyrate_mcmc_logs/Carnivora_occs_1_G_BDS_BDNN_16_8TVc_RTT.pdf', width = 9, height = 6, useDingbats = FALSE)

layout(matrix(1:4, ncol = 2, nrow = 2, byrow = TRUE))
par(las = 1, mar = c(4.5, 4.5, 0.5, 0.5))
time_vec=c(24.57494331175693, 22.00001,22.0,21.00001,21.0,20.00001,20.0,19.00001,19.0,18.00001,18.0,17.00001,17.0,16.00001,16.0,15.00001,15.0,14.00001,14.0,13.00001,13.0,12.00001,12.0,11.00001,11.0,10.00001,10.0,9.00001,9.0,8.00001,8.0,7.00001,7.0,6.00001,6.0,5.00001,5.0,4.00001,4.0,3.00001,3.0,2.00001,2.0,1.00001,1.0,0.0)
sp_mean=c(0.30107422499282344, 0.30107422499282344,0.27568046427690474,0.27568046427690474,0.2519927938443995,0.2519927938443995,0.23070531032327785,0.23070531032327785,0.19449403186507488,0.19449403186507488,0.16080580033023656,0.16080580033023656,0.13085608171330063,0.13085608171330063,0.1226581945900164,0.1226581945900164,0.11256469526738763,0.11256469526738763,0.10819136245591461,0.10819136245591461,0.10032090502594997,0.10032090502594997,0.09897230613419185,0.09897230613419185,0.09696966545509986,0.09696966545509986,0.09531736357535656,0.09531736357535656,0.09542574073268549,0.09542574073268549,0.09428597166962466,0.09428597166962466,0.09280588206473261,0.09280588206473261,0.09733226435073153,0.09733226435073153,0.10058360505031157,0.10058360505031157,0.10433835109436014,0.10433835109436014,0.10866251773768869,0.10866251773768869,0.1227536815420911,0.1227536815420911,0.13793836797579173,0.13793836797579173)
sp_lwr=c(0.20209293560396493, 0.20209293560396493,0.21744027625998044,0.21744027625998044,0.20290461462050458,0.20290461462050458,0.18270954257167596,0.18270954257167596,0.15568300436301008,0.15568300436301008,0.11922425275928641,0.11922425275928641,0.07644567404025143,0.07644567404025143,0.08441425675959294,0.08441425675959294,0.08542555930021296,0.08542555930021296,0.08437730600158651,0.08437730600158651,0.07767856748828207,0.07767856748828207,0.07926122443575147,0.07926122443575147,0.0797428198380339,0.0797428198380339,0.07689147045546571,0.07689147045546571,0.07293502170672495,0.07293502170672495,0.07313510560496506,0.07313510560496506,0.0687476334766183,0.0687476334766183,0.06976193587129322,0.06976193587129322,0.07245060826614651,0.07245060826614651,0.07782077473986572,0.07782077473986572,0.08473252587842423,0.08473252587842423,0.09663691606779376,0.09663691606779376,0.10324276091082896,0.10324276091082896)
sp_upr=c(0.39951822906533063, 0.39951822906533063,0.34972159879738995,0.34972159879738995,0.31074417029057577,0.31074417029057577,0.28982753063497413,0.28982753063497413,0.24506078410982185,0.24506078410982185,0.19665527791389065,0.19665527791389065,0.1925354937436846,0.1925354937436846,0.15728049430617244,0.15728049430617244,0.13966192490755874,0.13966192490755874,0.12285525414403337,0.12285525414403337,0.11337499649031257,0.11337499649031257,0.11012871020167703,0.11012871020167703,0.11150171579436235,0.11150171579436235,0.11093408280122821,0.11093408280122821,0.11546693583759125,0.11546693583759125,0.115055760253256,0.115055760253256,0.1210106367306192,0.1210106367306192,0.12428797430994579,0.12428797430994579,0.12695678221666543,0.12695678221666543,0.13508396285882643,0.13508396285882643,0.13770177335734024,0.13770177335734024,0.1527609831897652,0.1527609831897652,0.1785482248474004,0.1785482248474004)
ex_mean=c(0.07571323608506045, 0.07571323608506045,0.0710928603352691,0.0710928603352691,0.0704565472785049,0.0704565472785049,0.07588684597385276,0.07588684597385276,0.07020744057404507,0.07020744057404507,0.06551869983237449,0.06551869983237449,0.06179838017776131,0.06179838017776131,0.06192746203767287,0.06192746203767287,0.06242742219665082,0.06242742219665082,0.07612759239943037,0.07612759239943037,0.09054199484647377,0.09054199484647377,0.09045466614715732,0.09045466614715732,0.08663253399493595,0.08663253399493595,0.09707775466666793,0.09707775466666793,0.10281658750183449,0.10281658750183449,0.09315427367327905,0.09315427367327905,0.09424698896569786,0.09424698896569786,0.09610272127938187,0.09610272127938187,0.10076319470019739,0.10076319470019739,0.11295489999197461,0.11295489999197461,0.1761097614441317,0.1761097614441317,0.33399195260021786,0.33399195260021786,0.8571831462536746,0.8571831462536746)
ex_lwr=c(0.04842522194523622, 0.04842522194523622,0.051249888460669524,0.051249888460669524,0.049388522071914354,0.049388522071914354,0.05506005820285765,0.05506005820285765,0.04722514977980867,0.04722514977980867,0.049266797072092014,0.049266797072092014,0.047527250542115616,0.047527250542115616,0.04414439810466242,0.04414439810466242,0.04177892789652516,0.04177892789652516,0.057632685844478095,0.057632685844478095,0.0566767553808551,0.0566767553808551,0.0527260352374082,0.0527260352374082,0.06506747100320749,0.06506747100320749,0.07728443076952145,0.07728443076952145,0.08473347044689661,0.08473347044689661,0.072898510178441,0.072898510178441,0.07254302603381751,0.07254302603381751,0.07013213645045469,0.07013213645045469,0.06804980818338602,0.06804980818338602,0.07870101512330195,0.07870101512330195,0.11082591150244518,0.11082591150244518,0.2539619954429083,0.2539619954429083,0.5539852438924365,0.5539852438924365)
ex_upr=c(0.09124192772435337, 0.09124192772435337,0.09428277698272196,0.09428277698272196,0.08990349674394696,0.08990349674394696,0.09756435244786753,0.09756435244786753,0.09085340825892942,0.09085340825892942,0.08594209629503761,0.08594209629503761,0.08847401400274633,0.08847401400274633,0.0802056802035555,0.0802056802035555,0.07673436850533108,0.07673436850533108,0.0960024161995695,0.0960024161995695,0.1085164789365544,0.1085164789365544,0.1066873933345686,0.1066873933345686,0.12044854454305509,0.12044854454305509,0.13261992324092794,0.13261992324092794,0.13504616433704655,0.13504616433704655,0.12174617005096632,0.12174617005096632,0.12334605394515806,0.12334605394515806,0.12427997861063181,0.12427997861063181,0.13517674363842405,0.13517674363842405,0.16125779573609542,0.16125779573609542,0.2924426918727126,0.2924426918727126,0.4784519438120094,0.4784519438120094,1.0764161225675988,1.0764161225675988)
div_mean=c(0.22536098890776293, 0.22536098890776293,0.2045876039416356,0.2045876039416356,0.1815362465658945,0.1815362465658945,0.1548184643494251,0.1548184643494251,0.12428659129102979,0.12428659129102979,0.09528710049786207,0.09528710049786207,0.06905770153553932,0.06905770153553932,0.060730732552343514,0.060730732552343514,0.05013727307073681,0.05013727307073681,0.03206377005648426,0.03206377005648426,0.009778910179476194,0.009778910179476194,0.0085176399870345,0.0085176399870345,0.010337131460163896,0.010337131460163896,-0.0017603910913113995,-0.0017603910913113995,-0.007390846769148991,-0.007390846769148991,0.0011316979963455834,0.0011316979963455834,-0.0014411069009652555,-0.0014411069009652555,0.0012295430713496647,0.0012295430713496647,-0.0001795896498858092,-0.0001795896498858092,-0.008616548897614507,-0.008616548897614507,-0.06744724370644302,-0.06744724370644302,-0.2112382710581267,-0.2112382710581267,-0.7192447782778827,-0.7192447782778827)
div_lwr=c(0.13726953022318744, 0.13726953022318744,0.14205335494444724,0.14205335494444724,0.1267275795023817,0.1267275795023817,0.10525388447181569,0.10525388447181569,0.079141508865647,0.079141508865647,0.06695792752921152,0.06695792752921152,0.03365637416593406,0.03365637416593406,0.029105192307076713,0.029105192307076713,0.018776751956451107,0.018776751956451107,0.006183724234105334,0.006183724234105334,-0.024574802937384718,-0.024574802937384718,-0.025036898474118052,-0.025036898474118052,-0.022376053437946714,-0.022376053437946714,-0.0351437494293962,-0.0351437494293962,-0.035106878901751085,-0.035106878901751085,-0.030751678931190407,-0.030751678931190407,-0.028757425105728388,-0.028757425105728388,-0.027552758609961828,-0.027552758609961828,-0.027611184957126375,-0.027611184957126375,-0.052823465179199655,-0.052823465179199655,-0.18815070636500228,-0.18815070636500228,-0.3739103798929928,-0.3739103798929928,-0.9434208404093394,-0.9434208404093394)
div_upr=c(0.3323602202956677, 0.3323602202956677,0.26595857931279027,0.26595857931279027,0.23375193040772096,0.23375193040772096,0.20998310352823407,0.20998310352823407,0.1574320834105968,0.1574320834105968,0.14363688624683832,0.14363688624683832,0.15300512828183652,0.15300512828183652,0.0953410318260643,0.0953410318260643,0.07197795096991899,0.07197795096991899,0.06323227400106876,0.06323227400106876,0.04039291298157596,0.04039291298157596,0.035839295215975356,0.035839295215975356,0.03601524044271792,0.03601524044271792,0.023291669582198263,0.023291669582198263,0.021834843228106166,0.021834843228106166,0.024904720589662033,0.024904720589662033,0.025435820519787655,0.025435820519787655,0.02834994608351847,0.02834994608351847,0.03534286350257845,0.03534286350257845,0.02768398661211753,0.02768398661211753,0.01920915359308939,0.01920915359308939,-0.10267371622864518,-0.10267371622864518,-0.4152346915843864,-0.4152346915843864)
long_mean=c(13.727259563328763, 13.727259563328763,14.621433305672904,14.621433305672904,14.7422855484568,14.7422855484568,13.620903879512657,13.620903879512657,14.782722206390762,14.782722206390762,15.874087585928663,15.874087585928663,16.920372302430874,16.920372302430874,16.852513158052698,16.852513158052698,16.733697163556517,16.733697163556517,13.642923118192883,13.642923118192883,11.362532837804988,11.362532837804988,11.437703056919016,11.437703056919016,12.010862168152311,12.010862168152311,10.636176068066181,10.636176068066181,9.98251343224177,9.98251343224177,11.109628150925772,11.109628150925772,10.996960770432526,10.996960770432526,10.829985204907956,10.829985204907956,10.431399802900872,10.431399802900872,9.369888835593574,9.369888835593574,6.210903089105161,6.210903089105161,3.126699886682638,3.126699886682638,1.205661570088966,1.205661570088966)
long_lwr=c(10.959873656122788, 10.959873656122788,10.606391029225387,10.606391029225387,11.123037881920073,11.123037881920073,10.249645233225316,10.249645233225316,10.76377914855391,10.76377914855391,11.635741308508681,11.635741308508681,11.302753822935612,11.302753822935612,12.467944881984435,12.467944881984435,12.20540910329359,12.20540910329359,10.416404498832646,10.416404498832646,7.994169828041185,7.994169828041185,7.933991460890011,7.933991460890011,8.3023004038255,8.3023004038255,7.540345187678326,7.540345187678326,7.404875250689922,7.404875250689922,8.213810747240528,8.213810747240528,8.107271923304644,8.107271923304644,8.046348343307912,8.046348343307912,7.228665905493222,7.228665905493222,6.201250584105332,6.201250584105332,3.4194733798827697,3.4194733798827697,2.090074066859501,2.090074066859501,0.8912486212681417,0.8912486212681417)
long_upr=c(20.65039580264379, 20.65039580264379,19.512237587939836,19.512237587939836,20.247619447771804,20.247619447771804,18.161985886678547,18.161985886678547,20.470922856811814,20.470922856811814,20.297645867595204,20.297645867595204,21.040560701357293,21.040560701357293,22.652930902559582,22.652930902559582,22.996776252590195,22.996776252590195,17.35126491759384,17.35126491759384,13.701993036144152,13.701993036144152,14.387344691807389,14.387344691807389,15.368662475766195,15.368662475766195,12.93921673541482,12.93921673541482,11.801711823271901,11.801711823271901,13.717701466767972,13.717701466767972,13.784922613151375,13.784922613151375,14.25879847117529,14.25879847117529,14.438331709631603,14.438331709631603,12.706316410700502,12.706316410700502,9.023160616891806,9.023160616891806,3.937597033981425,3.937597033981425,1.6928232782423864,1.6928232782423864)
xlim = c(24.57494331175693, 0.0)
ylim = c(0.0687476334766183, 0.39951822906533063)
not_NA = !is.na(sp_mean)
plot(time_vec[not_NA], sp_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Speciation rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(sp_lwr[not_NA], rev(sp_upr[not_NA])), col = adjustcolor('#4c4cec', alpha = 0.5), border = NA)
lines(time_vec[not_NA], sp_mean[not_NA], col = '#4c4cec', lwd = 2)
ylim = c(0.04177892789652516, 1.0764161225675988)
not_NA = !is.na(ex_mean)
plot(time_vec[not_NA], ex_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Extinction rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(ex_lwr[not_NA], rev(ex_upr[not_NA])), col = adjustcolor('#e34a33', alpha = 0.5), border = NA)
lines(time_vec[not_NA], ex_mean[not_NA], col = '#e34a33', lwd = 2)
ylim = c(-0.9434208404093394, 0.3323602202956677)
not_NA = !is.na(div_mean)
plot(time_vec[not_NA], div_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Net diversification rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(div_lwr[not_NA], rev(div_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], div_mean[not_NA], col = 'black', lwd = 2)
abline(h = 0, col = 'red', lty = 2)
ylim = c(0.8912486212681417, 22.996776252590195)
not_NA = !is.na(long_mean)
plot(time_vec[not_NA], long_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Longevity (Myr)')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(long_lwr[not_NA], rev(long_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], long_mean[not_NA], col = 'black', lwd = 2)
dev.off()