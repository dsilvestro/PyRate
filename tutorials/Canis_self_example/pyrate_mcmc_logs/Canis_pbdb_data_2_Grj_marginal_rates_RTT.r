# 1 files combined:
# 	C:\Users\SimoesLabAdmin\Documents\PyRate\tutorials\Canis_self_example\pyrate_mcmc_logs/Canis_pbdb_data_2_Grj_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='C:/Users/SimoesLabAdmin/Documents/PyRate/tutorials/Canis_self_example/pyrate_mcmc_logs/Canis_pbdb_data_2_Grj_marginal_rates_RTT.pdf',width=10.8, height=8.4)
par(mfrow=c(2,2))
library(scales)
L_hpd_m95=c(0.287251110242247, 0.287251110242247,0.287481983206026,0.291297063095557,0.282159655668171,0.156337407070188,0.123350613205331,0.11618041996925,0.093776603635633,0.091518306834959,0.077566150325041,0.075341420311008,0.075410298964396,0.075341420311008,0.070202417462023,0.069710640805878,0.061713056463235,0.059479564813347,0.059755870596362,0.066764217835844,0.061713056463235)
L_hpd_M95=c(0.656103863785326, 0.656103863785326,0.656103863785326,0.670018070537541,0.679982759885676,0.653056470008669,0.620433633841873,0.61267400607014,0.587305059029321,0.583506513721032,0.566499246076555,0.56589695605793,0.565464236571146,0.566247681999931,0.558834009495806,0.558500630020731,0.553885163219405,0.554432843553811,0.559678203955939,0.577222487311084,0.585082315615456)
M_hpd_m95=c(0.583444433659047, 0.583444433659047,0.084522514873646,0.084522514873646,0.04127520407004,0.040785807430859,0.027237585569205,0.022791567833603,0.01844181400969,0.0170189772091,0.017119642024231,0.01767999249989,0.01844181400969,0.01767999249989,0.0170189772091,0.0170189772091,0.0170189772091,0.015364992232575,0.017376745462575,0.016529636578433,0.013147654847509)
M_hpd_M95=c(1.922734480245436, 1.922734480245436,0.462503165166735,0.447323755054635,0.344582413534983,0.33240862356616,0.312915499554582,0.302036609909783,0.295552515842714,0.291092562798723,0.290952641789312,0.290586894332793,0.290952641789312,0.289846465881721,0.289762178869128,0.289762178869128,0.290880925565241,0.291869839784024,0.295542689112631,0.295906123254576,0.295906123254576)
R_hpd_m95=c(-1.500206444227548, -1.500206444227548,-0.062160174274152,-0.036090235443351,0.025464793363145,-0.020268484939171,-0.074138621173518,-0.080015634763,-0.082346219064793,-0.102298428818489,-0.106787728028618,-0.12413811325019,-0.132323497946413,-0.134596343893342,-0.134596343893342,-0.136023927016411,-0.140497077268927,-0.145988134468566,-0.141306630588287,-0.140180746437348,-0.145645224386307)
R_hpd_M95=c(-0.1206381983873, -0.1206381983873,0.532068153277349,0.545204944099671,0.522061217196582,0.524829633335101,0.477054494059603,0.471373951967176,0.470624512111586,0.45496372219237,0.455711696892161,0.445071117616732,0.435055958668133,0.431345421160358,0.431345421160358,0.432487139817115,0.430960912237864,0.432380179992923,0.445531036478341,0.458956664143966,0.476134392487168)
L_mean=c(0.465635018659956, 0.465635018659956,0.466412075533699,0.470503313428747,0.466499121944968,0.438760722360568,0.413736291718748,0.389045682978137,0.376584509561276,0.368476048805864,0.359073616985561,0.349465385069289,0.342161463303931,0.336260085302325,0.33327962162462,0.331807487098987,0.331734216935328,0.33143107694665,0.333265661458299,0.3381812884806,0.345258120511723)
M_mean=c(1.2685331693642, 1.2685331693642,0.236509411441704,0.231281571680008,0.20020928372511,0.194616564968092,0.183582796450793,0.174774627870266,0.171614434745628,0.169275574622281,0.168399501519158,0.167951319495067,0.1676471361557,0.167036472272814,0.166926031168542,0.166745357457986,0.166868365736819,0.16763114306696,0.167875393580715,0.167907133102607,0.168806266792519)
R_mean=c(-0.802898150704244, -0.802898150704244,0.229902664091995,0.239221741748739,0.266289838219859,0.244144157392476,0.230153495267955,0.214271055107871,0.204970074815648,0.199200474183582,0.190674115466403,0.181514065574222,0.17451432714823,0.16922361302951,0.166353590456077,0.165062129641001,0.164865851198509,0.16379993387969,0.165390267877584,0.170274155377993,0.176451853719204)
trans=0.5
age=(0:(21-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.7479810358742437), xlim = c(-22.05,1.05), ylab = 'Speciation rate', xlab = 'Ma',main='Canis' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 2.11500792826998), xlim = c(-22.05,1.05), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.650227088650303, 0.5997254385096382), xlim = c(-22.05,1.05), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,rev(1/M_mean),type = 'n', xlim = c(-22.05,1.05), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()