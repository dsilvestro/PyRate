# 1 files combined:
# 	C:\Users\SimoesLabAdmin\Documents\PyRate\tutorials\Canis_self_example\pyrate_mcmc_logs/Canis_pbdb_data_1_Grj_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='C:/Users/SimoesLabAdmin/Documents/PyRate/tutorials/Canis_self_example/pyrate_mcmc_logs/Canis_pbdb_data_1_Grj_marginal_rates_RTT.pdf',width=10.8, height=8.4)
par(mfrow=c(2,2))
library(scales)
L_hpd_m95=c(0.359107883713766, 0.359107883713766,0.353421004091088,0.357714937753573,0.355676061922095,0.345507209463175,0.338287686605851,0.317527151624506,0.315850704574047,0.277668120332568,0.222174188971192,0.173855528908406,0.07914970806068,0.066788685059007,0.107455965802165,0.10848175354794,0.088463418923438,0.110456411095119,0.109096315813166,0.009214591667619,0.010212354960472)
L_hpd_M95=c(0.698078029198091, 0.698078029198091,0.689544082862072,0.696683871457584,0.697858062691166,0.698078029198091,0.719966766348521,0.72850435515141,0.747198922820065,0.747137864347476,0.747137864347476,0.7748428315052,0.93164385188462,1.516722167144862,1.852891843391156,2.030430724425311,2.143873793721697,2.33115099428432,2.439672153621506,2.461247021316372,2.596227208104755)
M_hpd_m95=c(0.646880776647987, 0.646880776647987,0.05275963534166,0.081475734633811,0.081411054128077,0.081475734633811,0.078044447879018,0.074979449173168,0.069158849655555,0.065063909472088,0.068899119118822,0.060332921796432,0.050014380532433,0.006337211699016,0.006993419583812,0.006337211699016,0.007408592291598,0.009560076312412,0.008547571166825,0.016034760023854,0.025282513144374)
M_hpd_M95=c(1.821711472642558, 1.821711472642558,0.409530792744471,0.346306722574394,0.346306722574394,0.348329433845471,0.348384919963808,0.348384919963808,0.346306722574394,0.349342096529666,0.361672204627532,0.366033071151992,0.394219259915879,0.6461371378548,1.06860969723267,1.435123739871969,1.651951161988897,1.917278176233156,2.146689946978006,2.281801653876382,2.474743618703392)
R_hpd_m95=c(-1.323205281369682, -1.323205281369682,0.025829664853984,0.111315816706085,0.106023405800201,0.096914526676485,0.074903247875306,0.059303796436754,0.045609749141729,0.03256551747667,-0.019477328731903,-0.078489339475101,-0.227799254232321,-0.682736872061235,-0.907760454629648,-1.31187908377863,-1.695254219790217,-1.804871189526594,-2.088616078945867,-2.17802078801694,-2.367579220793494)
R_hpd_M95=c(-0.092215987232651, -0.092215987232651,0.595940560291072,0.542910468626247,0.538603770049374,0.539490450726613,0.540768588579517,0.552976422631672,0.556132601613542,0.573051447151161,0.578919508257994,0.610679530749203,0.988439892804728,1.810674828516998,2.2924275024357,2.295967328208748,2.294981842710558,2.510915861849241,2.501872890640713,2.616796656979534,2.639814066272596)
L_mean=c(0.519904545812428, 0.519904545812428,0.519507177539522,0.521301781223314,0.521111138220355,0.519437263507351,0.512958052133681,0.50873006942868,0.5078960537752,0.508491359043862,0.5121455786594,0.521590536474988,0.566164941243928,0.633763502309387,0.672387774988282,0.702840019742996,0.73540211301285,0.769464622322314,0.802441079955378,0.833344760495695,0.866728784526791)
M_mean=c(1.207664774656454, 1.207664774656454,0.234218299045238,0.205850352135456,0.204100478209498,0.202885672089099,0.202357070905816,0.202628142512382,0.202731330868963,0.203186903946332,0.204664898663068,0.209338344757839,0.224914698880973,0.267358513438491,0.314582659213144,0.3667620942418,0.416296299462552,0.470504009309416,0.531375691336336,0.59434646726463,0.649574548211136)
R_mean=c(-0.687760228844026, -0.687760228844026,0.285288878494284,0.315451429087858,0.317010660010857,0.316551591418252,0.310600981227864,0.306101926916298,0.305164722906238,0.30530445509753,0.307480679996332,0.312252191717149,0.341250242362956,0.366404988870896,0.357805115775138,0.336077925501196,0.319105813550298,0.298960613012897,0.271065388619042,0.238998293231065,0.217154236315655)
trans=0.5
age=(0:(21-1))* -1
plot(age,age,type = 'n', ylim = c(0, 2.8558499289152306), xlim = c(-22.05,1.05), ylab = 'Speciation rate', xlab = 'Ma',main='Canis' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 2.7222179805737317), xlim = c(-22.05,1.05), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-2.6043371428728435, 2.903795472899856), xlim = c(-22.05,1.05), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,rev(1/M_mean),type = 'n', xlim = c(-22.05,1.05), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()